<!DOCTYPE html>
<html lang="sk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="theme-color" content="#0a0f1a">
<title>Clean Eating Agent ‚Äî P≈ô√≠bram</title>
<link rel="manifest" href="manifest.json">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,wght@0,400;0,500;0,700&family=JetBrains+Mono:wght@500&display=swap" rel="stylesheet">
<style>
:root{--bg:#0a0f1a;--bg2:#111827;--bg3:#1a2236;--surface:#1e2a3e;--border:#2a3654;--text:#e8ecf4;--text2:#8b97b0;--accent:#22d3ee;--green:#34d399;--yellow:#fbbf24;--red:#f87171;--orange:#fb923c;--purple:#a78bfa;--safe-top:env(safe-area-inset-top,0px);--safe-bottom:env(safe-area-inset-bottom,0px)}
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}
html{font-family:'DM Sans',-apple-system,sans-serif;background:var(--bg);color:var(--text);font-size:14px}
body{min-height:100dvh;padding-top:var(--safe-top);padding-bottom:calc(72px + var(--safe-bottom));overflow-x:hidden}

/* HEADER */
.hdr{position:sticky;top:0;z-index:100;background:rgba(10,15,26,0.88);backdrop-filter:blur(20px) saturate(180%);-webkit-backdrop-filter:blur(20px) saturate(180%);padding:calc(var(--safe-top)+10px) 16px 10px;border-bottom:1px solid var(--border)}
.hdr-top{display:flex;align-items:center;justify-content:space-between;margin-bottom:6px}
.logo{display:flex;align-items:center;gap:8px}
.logo-i{width:32px;height:32px;background:linear-gradient(135deg,var(--accent),var(--green));border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:16px}
.logo-t{font-size:15px;font-weight:700;letter-spacing:-0.3px}
.logo-s{font-size:10px;color:var(--text2);font-weight:500}
.badge{font-family:'JetBrains Mono',monospace;font-size:9px;background:rgba(34,211,238,0.15);color:var(--accent);padding:3px 8px;border-radius:16px;border:1px solid rgba(34,211,238,0.3)}
.hdr-acts{display:flex;gap:6px;align-items:center}
.ref-btn{background:rgba(52,211,153,0.15);color:var(--green);border:1px solid rgba(52,211,153,0.3);border-radius:16px;padding:3px 10px;font-size:9px;font-family:'JetBrains Mono',monospace;cursor:pointer;font-weight:600;transition:all .2s}
.ref-btn:active{transform:scale(.95)}
.ref-btn.loading{opacity:.5;pointer-events:none}
.ref-btn.ok{background:rgba(52,211,153,0.3)}
.ref-btn.err{background:rgba(248,113,113,0.15);color:var(--red);border-color:rgba(248,113,113,0.3)}
/* SOURCE BADGES */
.src-row{display:flex;align-items:center;gap:6px;flex-wrap:wrap;margin-top:4px}
.src-badge{font-size:9px;padding:2px 6px;border-radius:10px;font-weight:600;font-family:'JetBrains Mono',monospace}
.src-multi{background:rgba(34,211,238,0.15);color:var(--accent);border:1px solid rgba(34,211,238,0.3)}
.src-ver{background:rgba(52,211,153,0.15);color:var(--green);border:1px solid rgba(52,211,153,0.3)}
.src-unver{background:rgba(251,191,36,0.15);color:var(--yellow);border:1px solid rgba(251,191,36,0.3)}
/* CALENDAR */
.cal-strip{display:flex;gap:6px;padding:8px 16px;overflow-x:auto;scrollbar-width:none}
.cal-strip::-webkit-scrollbar{display:none}
.cal-day{flex-shrink:0;width:50px;height:62px;border-radius:12px;border:1px solid var(--border);background:var(--bg2);display:flex;flex-direction:column;align-items:center;justify-content:center;cursor:pointer;transition:all .2s;font-family:inherit}
.cal-day.on{background:var(--accent);color:var(--bg);border-color:var(--accent)}
.cal-day.urgent{border-color:var(--red)}
.cal-dn{font-size:10px;font-weight:700;opacity:.6}
.cal-dd{font-size:16px;font-weight:700}
.cal-dots{display:flex;gap:2px;margin-top:2px}
.cal-dot{width:4px;height:4px;border-radius:50%}
/* PROFILE */
.prof-modal{position:fixed;inset:0;z-index:200;background:rgba(0,0,0,0.75);display:flex;align-items:center;justify-content:center;padding:16px}
.prof-box{background:var(--bg2);border:1px solid var(--border);border-radius:16px;padding:20px;max-width:380px;width:100%;max-height:85vh;overflow-y:auto}
.prof-title{font-size:16px;font-weight:700;margin-bottom:16px;display:flex;justify-content:space-between;align-items:center}
.prof-section{margin-bottom:16px}
.prof-label{font-size:10px;font-weight:700;color:var(--accent);text-transform:uppercase;letter-spacing:1px;margin-bottom:8px}
.goal-btn{width:100%;padding:10px 14px;border-radius:10px;border:1px solid var(--border);background:rgba(255,255,255,0.02);text-align:left;cursor:pointer;margin-bottom:6px;transition:all .2s;font-family:inherit;color:var(--text)}
.goal-btn.on{border-color:var(--accent);background:rgba(34,211,238,0.08)}
.goal-btn .goal-name{font-weight:600;font-size:13px;margin-bottom:2px}
.goal-btn .goal-desc{font-size:11px;color:var(--text2)}
.excl-btn{padding:6px 14px;border-radius:16px;border:1px solid var(--border);background:transparent;color:var(--text2);font-size:12px;cursor:pointer;transition:all .2s;font-family:inherit}
.excl-btn.on{border-color:var(--red);background:rgba(248,113,113,0.12);color:var(--red);font-weight:600}
.watch-row{display:flex;gap:6px;margin-bottom:8px}
.watch-input{flex:1;padding:8px;border-radius:8px;border:1px solid var(--border);background:var(--bg3);color:var(--text);font-size:12px;font-family:inherit}
.watch-add{background:var(--accent);color:var(--bg);border:none;border-radius:8px;padding:0 14px;font-weight:700;cursor:pointer;font-family:inherit}
.watch-tags{display:flex;gap:4px;flex-wrap:wrap}
.watch-tag{padding:4px 10px;border-radius:12px;font-size:11px;background:rgba(251,191,36,0.12);color:var(--yellow);border:1px solid rgba(251,191,36,0.25);display:flex;align-items:center;gap:4px}
.watch-tag button{background:none;border:none;color:inherit;cursor:pointer;padding:0;font-size:12px}
.prof-save{width:100%;padding:12px;background:var(--accent);color:var(--bg);border:none;border-radius:10px;font-weight:700;cursor:pointer;font-size:14px;font-family:inherit}
/* NOTIFICATION DOT */
.notif-dot{width:8px;height:8px;border-radius:50%;background:var(--red);position:absolute;top:-2px;right:-2px;border:2px solid var(--bg)}
.prof-btn{position:relative;background:rgba(167,139,250,0.15);color:var(--purple);border:1px solid rgba(167,139,250,0.3);border-radius:16px;padding:3px 10px;font-size:9px;font-family:'JetBrains Mono',monospace;cursor:pointer;font-weight:600;transition:all .2s}
.token-modal{position:fixed;inset:0;z-index:200;background:rgba(0,0,0,0.7);display:flex;align-items:center;justify-content:center;padding:20px}
.token-box{background:var(--bg2);border:1px solid var(--border);border-radius:16px;padding:20px;max-width:340px;width:100%}
.token-title{font-size:14px;font-weight:700;margin-bottom:8px}
.token-desc{font-size:11px;color:var(--text2);margin-bottom:12px;line-height:1.4}
.token-input{width:100%;background:var(--bg3);border:1px solid var(--border);border-radius:8px;padding:10px;color:var(--text);font-size:12px;font-family:'JetBrains Mono',monospace;margin-bottom:12px}
.token-input:focus{outline:none;border-color:var(--accent)}
.token-btns{display:flex;gap:8px}
.token-save{flex:1;background:var(--accent);color:var(--bg);border:none;border-radius:8px;padding:8px;font-weight:700;font-size:12px;cursor:pointer;font-family:inherit}
.token-cancel{flex:1;background:var(--bg3);color:var(--text2);border:1px solid var(--border);border-radius:8px;padding:8px;font-weight:600;font-size:12px;cursor:pointer;font-family:inherit}
.week{font-size:11px;color:var(--text2);display:flex;align-items:center;gap:5px}
.wdot{width:5px;height:5px;background:var(--green);border-radius:50%;animation:pulse 2s infinite}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.4}}

/* STORE PICKER */
.store-pick{display:flex;gap:6px;padding:12px 16px 6px;overflow-x:auto;scrollbar-width:none;-webkit-overflow-scrolling:touch}
.store-pick::-webkit-scrollbar{display:none}
.sp-btn{flex-shrink:0;padding:8px 14px;border-radius:20px;border:1px solid var(--border);background:var(--bg2);color:var(--text2);font-size:12px;font-weight:600;cursor:pointer;transition:all .2s;font-family:inherit;display:flex;align-items:center;gap:5px}
.sp-btn.on{background:var(--accent);color:var(--bg);border-color:var(--accent)}
.sp-dot{width:8px;height:8px;border-radius:50%;flex-shrink:0}

/* CATEGORY NAV */
.cats{display:flex;gap:6px;padding:8px 16px 6px;overflow-x:auto;scrollbar-width:none;-webkit-overflow-scrolling:touch}
.cats::-webkit-scrollbar{display:none}
.cat{flex-shrink:0;padding:7px 14px;border-radius:20px;border:1px solid var(--border);background:var(--bg2);color:var(--text2);font-size:12px;font-weight:600;cursor:pointer;transition:all .2s;font-family:inherit}
.cat.on{background:var(--accent);color:var(--bg);border-color:var(--accent)}

/* STATS */
.stats{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;padding:8px 16px}
.st{background:var(--bg2);border:1px solid var(--border);border-radius:12px;padding:10px;text-align:center}
.st-v{font-family:'JetBrains Mono',monospace;font-size:18px;font-weight:700;color:var(--accent)}
.st-l{font-size:9px;color:var(--text2);margin-top:2px;text-transform:uppercase;letter-spacing:.5px}

/* CONTENT */
.ct{padding:6px 16px;display:flex;flex-direction:column;gap:10px}

/* PRODUCT CARD */
.pc{background:var(--bg2);border:1px solid var(--border);border-radius:14px;overflow:hidden;transition:transform .15s}
.pc:active{transform:scale(.98)}
.pc-main{padding:14px;display:flex;gap:12px;align-items:flex-start}
.ring{width:46px;height:46px;flex-shrink:0;position:relative}
.ring svg{transform:rotate(-90deg)}
.ring circle{fill:none;stroke-width:4}
.ring .trk{stroke:var(--bg3)}
.ring .fl{stroke-linecap:round}
.ring-v{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;font-family:'JetBrains Mono',monospace;font-size:13px;font-weight:700}
.pi{flex:1;min-width:0}
.pi-n{font-size:14px;font-weight:700;line-height:1.3;margin-bottom:3px}
.pi-m{font-size:11px;color:var(--text2);margin-bottom:6px}
.pr{display:flex;align-items:baseline;gap:6px;flex-wrap:wrap}
.pr-s{font-family:'JetBrains Mono',monospace;font-size:18px;font-weight:700;color:var(--green)}
.pr-u{font-size:10px;color:var(--text2)}
.pr-o{font-size:11px;color:var(--text2);text-decoration:line-through}
.pr-d{font-family:'JetBrains Mono',monospace;font-size:10px;font-weight:600;background:rgba(251,191,36,0.15);color:var(--yellow);padding:2px 6px;border-radius:8px}
.sbs{display:flex;gap:5px;margin-top:8px;flex-wrap:wrap}
.sb{font-size:10px;font-weight:600;padding:3px 8px;border-radius:6px;display:flex;align-items:center;gap:3px}
.sb.lidl{background:rgba(0,80,170,0.2);color:#4da3ff;border:1px solid rgba(0,80,170,0.3)}
.sb.kaufland{background:rgba(225,9,21,0.15);color:#ff6b6b;border:1px solid rgba(225,9,21,0.25)}
.sb.penny{background:rgba(205,23,25,0.15);color:#ff8080;border:1px solid rgba(205,23,25,0.25)}
.sb.billa{background:rgba(245,225,0,0.15);color:#f5e100;border:1px solid rgba(245,225,0,0.25)}
.sb.albert{background:rgba(226,0,26,0.15);color:#ff7070;border:1px solid rgba(226,0,26,0.25)}
.sb-p{font-family:'JetBrains Mono',monospace}
.validity{font-size:9px;color:var(--text2);margin-top:6px;opacity:.7}
.validity .active{color:var(--green)}
.validity .expired{color:var(--red)}
.src{display:inline-flex;align-items:center;gap:3px;font-size:9px;color:var(--text2);text-decoration:none;margin-top:4px;opacity:.5}
.src:hover{opacity:1}

/* NUTRITION BAR */
.nb{display:flex;gap:2px;padding:0 14px 10px}
.ni{flex:1;text-align:center;background:var(--bg3);padding:6px 3px;border-radius:6px}
.ni:first-child{border-radius:6px 3px 3px 6px}
.ni:last-child{border-radius:3px 6px 6px 3px}
.ni-v{font-family:'JetBrains Mono',monospace;font-size:12px;font-weight:700}
.ni-l{font-size:8px;color:var(--text2);text-transform:uppercase;letter-spacing:.3px;margin-top:1px}
.n100{font-size:8px;color:var(--text2);padding:0 14px 6px;text-align:right;font-style:italic}

/* BIO AUDIT */
.bt{display:flex;align-items:center;justify-content:space-between;padding:8px 14px;border-top:1px solid var(--border);cursor:pointer;font-size:11px;color:var(--accent);font-weight:600}
.bt .ar{transition:transform .3s;font-size:12px}
.bt.open .ar{transform:rotate(180deg)}
.bp{max-height:0;overflow:hidden;transition:max-height .4s ease;background:rgba(34,211,238,0.03)}
.bp.open{max-height:500px}
.bc{padding:10px 14px;display:flex;flex-direction:column;gap:8px}
.bi{display:flex;gap:8px;align-items:flex-start}
.bi-i{font-size:14px;flex-shrink:0;width:20px;text-align:center;margin-top:1px}
.bi-l{font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:.5px;color:var(--text2);margin-bottom:2px}
.bi-bar{height:3px;border-radius:2px;background:var(--bg3);margin:3px 0}
.bi-fill{height:100%;border-radius:2px}
.bi-d{font-size:10px;color:var(--text2);line-height:1.4}

/* STORE VIEW */
.sg{background:var(--bg2);border:1px solid var(--border);border-radius:14px;overflow:hidden}
.sg-h{padding:14px;display:flex;align-items:center;gap:10px;border-bottom:1px solid var(--border)}
.sg-i{width:36px;height:36px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:18px;font-weight:700}
.sg-n{font-size:15px;font-weight:700}
.sg-c{font-size:11px;color:var(--text2)}
.sp{padding:10px 14px;border-bottom:1px solid rgba(42,54,84,0.5);display:flex;justify-content:space-between;align-items:center}
.sp:last-child{border-bottom:none}
.sp-n{font-size:12px;font-weight:600}
.sp-m{font-size:10px;color:var(--text2);margin-top:1px}
.sp-pr{font-family:'JetBrains Mono',monospace;font-size:15px;font-weight:700;color:var(--green);text-align:right}
.sp-dc{font-size:9px;color:var(--yellow)}
.sp-vl{font-size:9px;color:var(--text2);margin-top:1px}

/* MEAL PLAN */
.day-pick{display:flex;gap:6px;padding:12px 16px 6px}
.dp-btn{flex:1;padding:10px;border-radius:12px;border:1px solid var(--border);background:var(--bg2);color:var(--text2);font-size:13px;font-weight:700;cursor:pointer;text-align:center;transition:all .2s;font-family:inherit}
.dp-btn.on{background:var(--accent);color:var(--bg);border-color:var(--accent)}
.dp-btn .dp-sub{font-size:9px;font-weight:500;opacity:.7;margin-top:2px}
.mc{background:var(--bg2);border:1px solid var(--border);border-radius:14px;overflow:hidden}
.mc-h{padding:14px;border-bottom:1px solid var(--border)}
.mc-type{font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:.5px;color:var(--accent);margin-bottom:3px}
.mc-title{font-size:16px;font-weight:700}
.mc-desc{font-size:11px;color:var(--text2);margin-top:3px;line-height:1.4}
.mc-ings{padding:10px 14px}
.mc-ings-t{font-size:10px;font-weight:700;text-transform:uppercase;color:var(--text2);margin-bottom:6px}
.mc-ing{font-size:11px;color:var(--text);padding:3px 0;display:flex;justify-content:space-between}
.mc-ing .mip{font-family:'JetBrains Mono',monospace;color:var(--green);font-size:10px}
.mc-steps{padding:10px 14px;border-top:1px solid var(--border)}
.mc-step{font-size:11px;color:var(--text2);padding:3px 0;line-height:1.4}
.mc-step b{color:var(--text);font-weight:600}
.mc-foot{padding:10px 14px;border-top:1px solid var(--border);display:flex;justify-content:space-between;align-items:center}
.mc-fl{font-size:11px;color:var(--text2)}
.mc-fp{font-family:'JetBrains Mono',monospace;font-size:16px;font-weight:700;color:var(--green)}

/* DAY HEADER */
.day-hdr{background:linear-gradient(135deg,rgba(34,211,238,0.08),rgba(52,211,153,0.08));border:1px solid rgba(34,211,238,0.2);border-radius:14px;padding:14px;text-align:center;margin-top:4px}
.day-hdr-t{font-size:14px;font-weight:700;color:var(--accent)}
.day-hdr-s{font-size:10px;color:var(--text2);margin-top:2px}

/* DAY TOTAL */
.dtot{background:linear-gradient(135deg,rgba(34,211,238,0.1),rgba(52,211,153,0.1));border:1px solid rgba(34,211,238,0.3);border-radius:14px;padding:16px;text-align:center}
.dtot-t{font-size:12px;font-weight:700;color:var(--accent);text-transform:uppercase;letter-spacing:.5px;margin-bottom:10px}
.dtot-g{display:grid;grid-template-columns:repeat(4,1fr);gap:6px}
.dtot-v{font-family:'JetBrains Mono',monospace;font-size:16px;font-weight:700}
.dtot-l{font-size:8px;color:var(--text2);text-transform:uppercase;margin-top:1px}
.dtot-price{margin-top:10px;font-family:'JetBrains Mono',monospace;font-size:15px;color:var(--green)}

/* SHOPPING LIST */
.sl-group{background:var(--bg2);border:1px solid var(--border);border-radius:14px;overflow:hidden}
.sl-store{padding:12px 14px;display:flex;align-items:center;gap:10px;border-bottom:1px solid var(--border)}
.sl-store-n{font-size:14px;font-weight:700}
.sl-item{padding:8px 14px;border-bottom:1px solid rgba(42,54,84,0.4);display:flex;justify-content:space-between;align-items:center;font-size:12px}
.sl-item:last-child{border-bottom:none}
.sl-item-n{flex:1}
.sl-item-a{color:var(--text2);font-size:11px;margin-left:8px}
.sl-item-p{font-family:'JetBrains Mono',monospace;color:var(--green);font-size:12px;font-weight:600;margin-left:10px}
.sl-total{padding:12px 14px;border-top:1px solid var(--border);display:flex;justify-content:space-between;align-items:center;background:rgba(34,211,238,0.05)}
.sl-total-l{font-size:12px;font-weight:600}
.sl-total-p{font-family:'JetBrains Mono',monospace;font-size:16px;font-weight:700;color:var(--green)}

/* BUDGET */
.budget{background:linear-gradient(135deg,rgba(52,211,153,0.1),rgba(34,211,238,0.1));border:1px solid rgba(52,211,153,0.3);border-radius:14px;padding:16px;text-align:center}
.budget-t{font-size:12px;font-weight:700;color:var(--green);text-transform:uppercase;margin-bottom:8px}
.budget-v{font-family:'JetBrains Mono',monospace;font-size:28px;font-weight:700;color:var(--green)}
.budget-s{font-size:11px;color:var(--text2);margin-top:4px}

/* BOTTOM NAV */
.bnav{position:fixed;bottom:0;left:0;right:0;z-index:100;background:rgba(10,15,26,0.92);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);border-top:1px solid var(--border);display:flex;padding:6px 12px calc(6px + var(--safe-bottom))}
.nv{flex:1;display:flex;flex-direction:column;align-items:center;gap:3px;padding:5px;border-radius:10px;cursor:pointer;transition:all .2s;background:none;border:none;color:var(--text2);font-family:inherit}
.nv.on{color:var(--accent)}
.nv-i{font-size:18px}
.nv-l{font-size:9px;font-weight:600}

.empty{text-align:center;padding:30px 16px;color:var(--text2)}
.empty-i{font-size:40px;margin-bottom:8px}
.empty-t{font-size:14px;font-weight:700;color:var(--text)}
.ftr{text-align:center;padding:16px;font-size:10px;color:var(--text2);opacity:.4}
.hidden{display:none!important}
.fi{animation:fi .3s ease backwards}
@keyframes fi{from{opacity:0;transform:translateY(12px)}}
</style>
</head>
<body>

<div class="hdr">
  <div class="hdr-top">
    <div class="logo"><div class="logo-i">üî¨</div><div><div class="logo-t">Clean Eating Agent</div><div class="logo-s">P≈ô√≠bram ‚Äî Biomedic√≠nsky audit</div></div></div>
    <div class="hdr-acts"><button class="prof-btn" id="profBtn" onclick="openProfile()">üë§ Profil</button><button class="ref-btn" id="refBtn" onclick="triggerScrape()">üîÑ Aktualizova≈•</button><div class="badge" id="badge">LIVE</div></div>
  </div>
  <div class="week"><span class="wdot"></span><span id="winfo">Naƒç√≠tanie...</span></div>
</div>

<div class="token-modal hidden" id="tokenModal">
  <div class="token-box">
    <div class="token-title">üîë GitHub Token</div>
    <div class="token-desc">Zadaj svoj GitHub Personal Access Token. Ulo≈æ√≠ sa len lok√°lne v tvojom zariaden√≠ ‚Äî nikam sa neodosiela okrem GitHub API.</div>
    <input class="token-input" id="tokenInput" type="password" placeholder="ghp_xxxxxxxxxxxx">
    <div class="token-btns">
      <button class="token-cancel" onclick="closeToken()">Zru≈°i≈•</button>
      <button class="token-save" onclick="saveToken()">Ulo≈æi≈•</button>
    </div>
  </div>
</div>

<!-- AUDIT VIEW -->
<div id="vAudit">
  <div class="store-pick" id="storePick"></div>
  <div class="cats" id="catNav"></div>
  <div class="stats" id="stats"></div>
  <div class="ct" id="prodList"></div>
</div>

<!-- STORES VIEW -->
<div id="vStores" class="hidden">
  <div class="ct" id="storeList" style="padding-top:12px"></div>
</div>

<!-- MEAL PLAN VIEW -->
<div id="vPlan" class="hidden">
  <div class="day-pick" id="dayPick"></div>
  <div class="ct" id="mealPlan"></div>
</div>

<!-- SHOPPING LIST VIEW -->
<div id="vShop" class="hidden">
  <div class="ct" id="shopList" style="padding-top:12px"></div>
</div>

<!-- CALENDAR VIEW -->
<div id="vCal" class="hidden">
  <div class="cal-strip" id="calStrip"></div>
  <div class="ct" id="calList" style="padding-top:8px"></div>
</div>

<!-- PROFILE MODAL -->
<div class="prof-modal hidden" id="profModal">
  <div class="prof-box">
    <div class="prof-title"><span>üë§ M√¥j Bio-Profil</span><button onclick="closeProfile()" style="background:none;border:none;color:var(--text2);font-size:20px;cursor:pointer">√ó</button></div>
    <div class="prof-section">
      <div class="prof-label">üéØ Hlavn√Ω cieƒæ</div>
      <div id="profGoals"></div>
    </div>
    <div class="prof-section">
      <div class="prof-label" style="color:var(--red)">üö´ Intolerancie</div>
      <div id="profExcl" style="display:flex;gap:6px;flex-wrap:wrap"></div>
    </div>
    <div class="prof-section">
      <div class="prof-label" style="color:var(--yellow)">üîî Watchlist (Notifik√°cie)</div>
      <div class="watch-row"><input class="watch-input" id="watchInput" placeholder="Napr. losos, mandle..."><button class="watch-add" onclick="addWatch()">+</button></div>
      <div class="watch-tags" id="watchTags"></div>
    </div>
    <button class="prof-save" onclick="saveProfile()">Ulo≈æi≈• profil</button>
  </div>
</div>

<div class="ftr">üì° Kupi.cz + iLetaky.cz + AkcniCeny.cz ¬∑ Cross-overen√© ceny ¬∑ 0 Kƒç</div>

<nav class="bnav">
  <button class="nv on" data-v="audit"><span class="nv-i">üî¨</span><span class="nv-l">Audit</span></button>
  <button class="nv" data-v="stores"><span class="nv-i">üè™</span><span class="nv-l">Obchody</span></button>
  <button class="nv" data-v="cal"><span class="nv-i">üìÖ</span><span class="nv-l">Kalend√°r</span></button>
  <button class="nv" data-v="plan"><span class="nv-i">üìã</span><span class="nv-l">Jed√°lniƒçek</span></button>
  <button class="nv" data-v="shop"><span class="nv-i">üõí</span><span class="nv-l">N√°kup</span></button>
</nav>

<script>
// ==================== CONFIG ====================
const SC={'Lidl':'lidl','Kaufland':'kaufland','Penny Market':'penny','Billa':'billa','Albert':'albert'};
const SCOL={'Lidl':'#4da3ff','Kaufland':'#ff6b6b','Penny Market':'#ff8080','Billa':'#f5e100','Albert':'#ff7070'};
const SICO={'Lidl':'üîµ','Kaufland':'üî¥','Penny Market':'üü°','Billa':'üü°','Albert':'üî¥'};
const CL={all:{i:'üõí',l:'V≈°etko'},meat:{i:'ü•©',l:'M√§so'},fish:{i:'üêü',l:'Ryby'},dairy:{i:'ü•õ',l:'Mlieƒçne'},produce:{i:'ü•¨',l:'Zelenina'},pantry:{i:'ü´ò',l:'Trvanliv√©'}};
const BIO_I={microbiome:'ü¶†',cardiovascular:'‚ù§Ô∏è',metabolism:'‚ö°'};
const BIO_L={microbiome:'Mikrobi√≥m',cardiovascular:'Kardiovaskul√°rne',metabolism:'Metabolizmus'};

let D=null, activeCat='all', activeView='audit', selectedStores=new Set(['Lidl','Kaufland','Penny Market','Billa','Albert']), planDays=3;

// ==================== NAV ====================
document.querySelectorAll('.nv').forEach(b=>b.addEventListener('click',()=>{
  activeView=b.dataset.v;
  document.querySelectorAll('.nv').forEach(x=>x.classList.remove('on'));
  b.classList.add('on');
  ['vAudit','vStores','vPlan','vShop','vCal'].forEach(id=>{
    const el=document.getElementById(id);
    if(el)el.classList.toggle('hidden',id!=='v'+activeView.charAt(0).toUpperCase()+activeView.slice(1));
  });
  if(activeView==='stores')renderStores();
  if(activeView==='plan')renderPlan();
  if(activeView==='shop')renderShop();
  if(activeView==='cal')renderCalendar();
}));

// ==================== DATA ====================
async function loadData(){
  // Try scraper output first (products.json), then verified data, then embedded
  const paths=[
    '../data/products.json',
    'data/products.json',
    './data/products.json',
    '../data/products_verified_2026-02-10.json',
    'data/products_verified_2026-02-10.json',
    './data/products_verified_2026-02-10.json'
  ];
  for(const p of paths){
    try{
      const r=await fetch(p,{cache:'no-store'});
      if(r.ok){
        const raw=await r.json();
        // Normalize format ‚Äî scraper uses {products:[...]}, old format uses {products:[...]} too
        D=raw;
        // If scraper format (has total_products), adapt flyer_week from generated_at
        if(raw.generated_at && !raw.flyer_week){
          const d=new Date(raw.generated_at);
          D.flyer_week=d.toLocaleDateString('cs-CZ');
          D.note='Multi-source scraping ¬∑ '+D.flyer_week;
        }
        const srcs=raw.sources||['kupi.cz'];
        document.getElementById('badge').textContent=raw.generated_at?'LIVE '+srcs.length+'√ó':'DATA';
        init();
        return;
      }
    }catch(e){}
  }
  D=EDATA;
  document.getElementById('badge').textContent='OFFLINE';
  init();
}

function init(){renderWeek();renderStorePick();renderCats();renderStats();renderProds();renderDayPick();checkWatchNotifs();}

// ==================== HELPERS ====================
function scol(s){return s>=90?'var(--green)':s>=75?'var(--accent)':s>=60?'var(--yellow)':'var(--orange)'}
function bcol(s){return s>=8?'var(--green)':s>=6?'var(--accent)':s>=4?'var(--yellow)':'var(--red)'}
function fmt(n){return n.toFixed(2).replace('.',',')}
function today(){return new Date().toISOString().slice(0,10)}
function isValid(o){if(!o.valid_until)return true;return o.valid_until>=today()}
function validLabel(o){
  if(!o.valid_from)return'';
  const fd=new Date(o.valid_from);
  const td=new Date(o.valid_until);
  const f=fd.getDate()+'.'+(fd.getMonth()+1)+'.';
  const t=td.getDate()+'.'+(td.getMonth()+1)+'.';
  const cls=isValid(o)?'active':'expired';
  return '<span class="'+cls+'">'+f+' ‚Äì '+t+'</span>';
}

function getFiltered(){
  let p=D?.products||[];
  // Filter by selected stores
  p=p.filter(x=>(x.offers||[]).some(o=>selectedStores.has(o.store)));
  if(activeCat!=='all')p=p.filter(x=>x.category===activeCat);
  return p;
}

// ==================== WEEK INFO ====================
function renderWeek(){
  document.getElementById('winfo').textContent=D?.flyer_week
    ?'Let√°k '+D.flyer_week+' ¬∑ '+D.note
    :'Aktualizovan√© '+new Date().toLocaleDateString('cs-CZ');
}

// ==================== STORE PICKER ====================
function renderStorePick(){
  const el=document.getElementById('storePick');
  el.innerHTML=['Lidl','Kaufland','Penny Market','Billa','Albert'].map(s=>
    '<button class="sp-btn '+(selectedStores.has(s)?'on':'')+'" data-store="'+s+'"><span class="sp-dot" style="background:'+SCOL[s]+'"></span>'+s+'</button>'
  ).join('');
  el.querySelectorAll('.sp-btn').forEach(b=>b.addEventListener('click',()=>{
    const s=b.dataset.store;
    if(selectedStores.has(s)){if(selectedStores.size>1)selectedStores.delete(s);}
    else selectedStores.add(s);
    renderStorePick();renderStats();renderProds();
  }));
}

// ==================== CATEGORIES ====================
function renderCats(){
  const nav=document.getElementById('catNav');
  const prods=D?.products||[];
  const cts={all:prods.filter(p=>(p.offers||[]).some(o=>selectedStores.has(o.store))).length};
  prods.forEach(p=>{if((p.offers||[]).some(o=>selectedStores.has(o.store)))cts[p.category]=(cts[p.category]||0)+1;});
  nav.innerHTML=Object.entries(CL).filter(([k])=>k==='all'||cts[k]).map(([k,{i,l}])=>
    '<button class="cat '+(k===activeCat?'on':'')+'" data-c="'+k+'">'+i+' '+l+' '+(cts[k]||0)+'</button>'
  ).join('');
  nav.querySelectorAll('.cat').forEach(b=>b.addEventListener('click',()=>{activeCat=b.dataset.c;renderCats();renderStats();renderProds();}));
}

// ==================== STATS ====================
function renderStats(){
  const p=getFiltered(),len=Math.max(p.length,1);
  const ad=p.reduce((s,x)=>s+(x.max_discount||0),0)/len;
  const as=p.reduce((s,x)=>s+(x.clean_score||0),0)/len;
  document.getElementById('stats').innerHTML=
    '<div class="st"><div class="st-v">'+p.length+'</div><div class="st-l">Produktov</div></div>'+
    '<div class="st"><div class="st-v" style="color:var(--yellow)">-'+Math.round(ad)+'%</div><div class="st-l">√ò Zƒæava</div></div>'+
    '<div class="st"><div class="st-v" style="color:var(--green)">'+Math.round(as)+'</div><div class="st-l">√ò Score</div></div>';
}

// ==================== PRODUCT CARDS ====================
function renderProds(){
  const c=document.getElementById('prodList');
  const prods=[...getFiltered()].sort((a,b)=>(b.is_priority?1:0)-(a.is_priority?1:0)||(b.clean_score||0)-(a.clean_score||0));
  if(!prods.length){c.innerHTML='<div class="empty fi"><div class="empty-i">üîç</div><div class="empty-t">≈Ωiadne produkty</div></div>';return;}

  c.innerHTML=prods.map((p,i)=>{
    const sc=p.clean_score||0,col=scol(sc),C=2*Math.PI*20,off=C-(sc/100)*C;
    const offers=(p.offers||[]).filter(o=>selectedStores.has(o.store));
    const best=offers.reduce((b,o)=>(!b||o.sale_price<b.sale_price)?o:b,null);
    const n=p.nutrition,id='b'+i;
    let h='<div class="pc fi" style="animation-delay:'+(i*.03)+'s">';
    h+='<div class="pc-main"><div class="ring"><svg width="46" height="46" viewBox="0 0 46 46"><circle class="trk" cx="23" cy="23" r="20"/><circle class="fl" cx="23" cy="23" r="20" stroke="'+col+'" stroke-dasharray="'+C+'" stroke-dashoffset="'+off+'"/></svg><div class="ring-v" style="color:'+col+'">'+sc+'</div></div>';
    h+='<div class="pi"><div class="pi-n">'+(p.is_priority?'‚≠ê ':'')+p.name+'</div>';
    h+='<div class="pi-m">'+(CL[p.category]?.i||'')+' '+(CL[p.category]?.l||p.category)+'</div>';
    if(best){
      h+='<div class="pr"><span class="pr-s">'+fmt(best.sale_price)+' Kƒç</span><span class="pr-u">/ '+(best.unit||'ks')+'</span>';
      if(p.regular_price)h+='<span class="pr-o">'+fmt(p.regular_price)+' Kƒç</span>';
      if(p.max_discount)h+='<span class="pr-d">-'+p.max_discount+'%</span>';
      h+='</div>';
    }
    h+='<div class="sbs">';
    offers.forEach(o=>{
      h+='<div class="sb '+(SC[o.store]||'')+'">'+o.store+' <span class="sb-p">'+fmt(o.sale_price)+'</span></div>';
    });
    h+='</div>';
    // Validity
    if(offers.length){
      h+='<div class="validity">';
      offers.forEach(o=>{if(o.valid_from)h+=o.store+': '+validLabel(o)+' ';});
      h+='</div>';
    }
    if(p.source_url){
      const srcs=p.sources_checked||['kupi.cz'];
      const ver=p.verification&&p.verification.verified;
      h+='<div class="src-row">';
      h+='<a class="src" href="'+p.source_url+'" target="_blank">üîó Kupi.cz</a>';
      if(srcs.length>1)h+='<span class="src-badge src-multi">üì° '+srcs.length+' zdroje</span>';
      if(ver)h+='<span class="src-badge src-ver">‚úì Overen√° cena</span>';
      else if(p.verification)h+='<span class="src-badge src-unver">‚ö† Neoveren√©</span>';
      h+='</div>';
    }
    h+='</div></div>';
    // Nutrition
    if(n){
      h+='<div class="nb"><div class="ni"><div class="ni-v" style="color:var(--accent)">'+n.kcal+'</div><div class="ni-l">kcal</div></div>';
      h+='<div class="ni"><div class="ni-v" style="color:var(--green)">'+n.protein+'g</div><div class="ni-l">Bielk.</div></div>';
      h+='<div class="ni"><div class="ni-v" style="color:var(--yellow)">'+n.carbs+'g</div><div class="ni-l">Sach.</div></div>';
      h+='<div class="ni"><div class="ni-v" style="color:var(--orange)">'+n.fat+'g</div><div class="ni-l">Tuky</div></div>';
      h+='<div class="ni"><div class="ni-v" style="color:var(--purple)">'+n.fiber+'g</div><div class="ni-l">Vl√°kn.</div></div></div>';
      h+='<div class="n100">na 100g</div>';
    }
    // Bio audit
    if(p.bio_audit){
      h+='<div class="bt" onclick="tBio(\''+id+'\',this)">üî¨ Biomedic√≠nsky audit <span class="ar">‚ñº</span></div>';
      h+='<div class="bp" id="'+id+'"><div class="bc">';
      Object.entries(p.bio_audit).forEach(([k,v])=>{
        h+='<div class="bi"><div class="bi-i">'+(BIO_I[k]||'üìä')+'</div><div style="flex:1"><div class="bi-l">'+(BIO_L[k]||k)+' ‚Äî '+v.score+'/10</div>';
        h+='<div class="bi-bar"><div class="bi-fill" style="width:'+(v.score*10)+'%;background:'+bcol(v.score)+'"></div></div>';
        h+='<div class="bi-d">'+v.detail+'</div></div></div>';
      });
      h+='</div></div>';
    }
    h+='</div>';
    return h;
  }).join('');
}

function tBio(id,el){const p=document.getElementById(id);const o=p.classList.contains('open');document.querySelectorAll('.bp.open').forEach(x=>{x.classList.remove('open');x.previousElementSibling.classList.remove('open');});if(!o){p.classList.add('open');el.classList.add('open');}}

// ==================== STORES VIEW ====================
function renderStores(){
  const c=document.getElementById('storeList');
  const prods=D?.products||[];
  const sm={};
  prods.forEach(p=>(p.offers||[]).forEach(o=>{
    if(!selectedStores.has(o.store))return;
    if(!sm[o.store])sm[o.store]=[];
    sm[o.store].push({name:p.name,category:p.category,is_priority:p.is_priority,clean_score:p.clean_score,max_discount:p.max_discount,sale_price:o.sale_price,unit:o.unit,valid_from:o.valid_from,valid_until:o.valid_until});
  }));
  const so=['Lidl','Kaufland','Penny Market','Billa','Albert'];
  c.innerHTML=so.filter(s=>sm[s]).map((store,si)=>{
    const items=sm[store].sort((a,b)=>a.sale_price-b.sale_price);
    return '<div class="sg fi" style="animation-delay:'+(si*.06)+'s"><div class="sg-h"><div class="sg-i" style="background:'+SCOL[store]+'22;color:'+SCOL[store]+'">'+(SICO[store]||'üè™')+'</div><div><div class="sg-n">'+store+'</div><div class="sg-c">'+items.length+' clean produktov</div></div></div>'+
      items.map(it=>'<div class="sp"><div><div class="sp-n">'+(it.is_priority?'‚≠ê ':'')+it.name+'</div><div class="sp-m">'+(CL[it.category]?.i||'')+' '+(it.unit||'')+' ¬∑ Score '+(it.clean_score||'-')+'</div>'+(it.valid_from?'<div class="sp-vl">'+validLabel(it)+'</div>':'')+'</div><div><div class="sp-pr">'+fmt(it.sale_price)+' Kƒç</div>'+(it.max_discount?'<div class="sp-dc">-'+it.max_discount+'%</div>':'')+'</div></div>').join('')+
    '</div>';
  }).join('')||'<div class="empty"><div class="empty-i">üè™</div><div class="empty-t">Vyber obchod v Audit tabe</div></div>';
}

// ==================== MEAL PLAN ====================
function renderDayPick(){
  const el=document.getElementById('dayPick');
  el.innerHTML=[1,2,3,4,5].map(d=>
    '<button class="dp-btn '+(d===planDays?'on':'')+'" data-d="'+d+'">'+d+'<div class="dp-sub">'+(d===1?'de≈à':'dn√≠')+'</div></button>'
  ).join('');
  el.querySelectorAll('.dp-btn').forEach(b=>b.addEventListener('click',()=>{planDays=+b.dataset.d;renderDayPick();renderPlan();}));
}

// Meal recipe database - 25 unique meals
const MEALS=[
  {type:'üåÖ Ra≈àajky',title:'Tvarohov√° misa s ovoc√≠m',desc:'R√Ωchle prote√≠nov√© ra≈àajky.',ings:[{q:'tvaroh',a:'125g',g:125},{q:'jogurt',a:'100g',g:100},{q:'ban√°n',a:'1ks',g:120},{q:'kiwi',a:'1ks',g:80}],steps:['Tvaroh zmie≈°ajte s jogurtom.','Pridajte nakr√°jan√© ovocie.','Posypte orechmi.']},
  {type:'üåÖ Ra≈àajky',title:'Ovesn√° ka≈°a s jablkom a medom',desc:'Pomal√© sacharidy na cel√© r√°no.',ings:[{q:'ovesn√©',a:'60g',g:60},{q:'jablk',a:'1ks',g:150},{q:'med',a:'1 ly≈æ.',g:15},{q:'mandl',a:'20g',g:20}],steps:['Vloƒçky varte 5 min v 200ml vody.','Pridajte nastr√∫han√© jablko.','Pokvapkajte medom, posypte mandƒæami.']},
  {type:'üåÖ Ra≈àajky',title:'Mie≈°an√© vaj√≠ƒçka so ≈°pen√°tom',desc:'Prote√≠nov√° bomba s ≈æelezom.',ings:[{q:'ejce',a:'3ks',g:180},{q:'≈°pen√°t',a:'50g',g:50},{q:'m√°slo',a:'10g',g:10},{q:'rajƒçat',a:'1ks',g:100}],steps:['Na masle orestujte ≈°pen√°t.','Pridajte roz≈°ƒæahan√© vajcia, mie≈°ajte.','Pod√°vajte s nakr√°jan√Ωm rajƒçinom.']},
  {type:'üåÖ Ra≈àajky',title:'Gr√©cky jogurt s orechmi a ovoc√≠m',desc:'Vysokoproteinov√Ω ≈°tart d≈àa.',ings:[{q:'≈ôeck',a:'140g',g:140},{q:'mandl',a:'20g',g:20},{q:'hrozn',a:'80g',g:80},{q:'med',a:'1 ly≈æ.',g:10}],steps:['Do jogurtu pridajte orechy a ovocie.','Pokvapkajte medom.']},
  {type:'üåÖ Ra≈àajky',title:'Vaj√≠ƒçkov√° omeleta so zeleninou',desc:'R√Ωchla a s√Ωta.',ings:[{q:'ejce',a:'3ks',g:180},{q:'paprik',a:'50g',g:50},{q:'cibul',a:'30g',g:30},{q:'mozzarell',a:'30g',g:30}],steps:['Zeleninu nakr√°jajte a orestujte.','Zalejte roz≈°ƒæahan√Ωmi vajcami.','Posypte mozzarellou, priklopte.']},

  {type:'ü•ê Desiata',title:'Jablko s mandƒæami',desc:'Vl√°knina + zdrav√© tuky.',ings:[{q:'jablk',a:'1ks',g:150},{q:'mandl',a:'20g',g:20}],steps:['Jablko nakr√°jajte, jedzte s mandƒæami.']},
  {type:'ü•ê Desiata',title:'Tvaroh s mrkovou',desc:'Prote√≠n + beta-karot√©n.',ings:[{q:'tvaroh',a:'80g',g:80},{q:'mrkev',a:'100g',g:100}],steps:['Tvaroh osolte, jedzte s mrkvov√Ωmi tyƒçinkami.']},
  {type:'ü•ê Desiata',title:'Ban√°n s mandƒæov√Ωm maslom',desc:'R√Ωchla energia.',ings:[{q:'ban√°n',a:'1ks',g:120},{q:'mandl',a:'15g',g:15}],steps:['Ban√°n nakr√°jajte, posypte drven√Ωmi mandƒæami.']},
  {type:'ü•ê Desiata',title:'Vaj√≠ƒçko natvrdo s okurkou',desc:'Chol√≠n + hydrat√°cia.',ings:[{q:'ejce',a:'2ks',g:120},{q:'okurk',a:'100g',g:100}],steps:['Vaj√≠ƒçka uvarte 9 min, jedzte s okurkou.']},
  {type:'ü•ê Desiata',title:'Gr√©cky jogurt s hroznami',desc:'Probiotika + antioxidanty.',ings:[{q:'≈ôeck',a:'100g',g:100},{q:'hrozn',a:'80g',g:80}],steps:['Jogurt zmie≈°ajte s hroznami.']},

  {type:'‚òÄÔ∏è Obed',title:'Grilovan√© ku≈ôec√≠ prsa so zeleninou',desc:'Vysokoproteinov√Ω klasik.',ings:[{q:'ku≈ôec√≠ prsn√≠',a:'200g',g:200},{q:'brokolice',a:'150g',g:150},{q:'olivov√Ω',a:'1 ly≈æ.',g:13},{q:'mrkev',a:'100g',g:100}],steps:['Ku≈ôec√≠ prsa ochucte a grilujte 6-7 min z ka≈ædej strany.','Zeleninu oparte alebo pod√°vajte ƒçerstv√∫.','Pokvapkajte olivov√Ωm olejom.']},
  {type:'‚òÄÔ∏è Obed',title:'ƒåoƒçkov√° pol√©vka',desc:'Rastlinn√© bielkoviny + ≈æelezo.',ings:[{q:'ƒçoƒçk',a:'100g',g:100},{q:'mrkev',a:'100g',g:100},{q:'cibul',a:'50g',g:50},{q:'ƒçesnek',a:'10g',g:10}],steps:['Cibuƒæu a mrkvu orestujte.','Pridajte ƒçoƒçku a 500ml vody, varte 20 min.','Dochu≈•te cesnakom a soƒæou.']},
  {type:'‚òÄÔ∏è Obed',title:'Losos s brokolicou a ry≈æou',desc:'Omega-3 + komplex sacharidov.',ings:[{q:'losos',a:'150g',g:150},{q:'brokolice',a:'150g',g:150},{q:'r√Ω≈æ',a:'80g',g:80},{q:'olivov√Ω',a:'1 ly≈æ.',g:13}],steps:['Ry≈æu uvarte podƒæa n√°vodu.','Lososa opekajte 4+2 min na panvici.','Brokolicou oparte 5 min, pod√°vajte spolu.']},
  {type:'‚òÄÔ∏è Obed',title:'Kr≈Øt√≠ prsa s paprikou a tƒõstovinami',desc:'Libov√© m√§so + vitam√≠n C.',ings:[{q:'kr≈Øt√≠',a:'200g',g:200},{q:'paprik',a:'150g',g:150},{q:'tƒõstovin',a:'80g',g:80},{q:'olivov√Ω',a:'1 ly≈æ.',g:13}],steps:['Tƒõstoviny uvarte al dente.','Kr≈Øt√≠ nakr√°jajte a orestujte s paprikou.','Zmie≈°ajte s tƒõstovinami.']},
  {type:'‚òÄÔ∏è Obed',title:'Treska s mrkvou a zemiakmi',desc:'N√≠zkotuƒçn√° ryba s vl√°kninou.',ings:[{q:'tresk',a:'200g',g:200},{q:'mrkev',a:'150g',g:150},{q:'cibul',a:'50g',g:50},{q:'olivov√Ω',a:'1 ly≈æ.',g:13}],steps:['Tresku opeƒçte na panvici 3 min z ka≈ædej strany.','Mrkvu a cibuƒæu poduste na oleji.','Pod√°vajte spolu.']},

  {type:'üçé Olovrant',title:'Pomeranƒç + orechy',desc:'Vitam√≠n C + omega-3.',ings:[{q:'pomeranƒç',a:'1ks',g:150},{q:'mandl',a:'15g',g:15}],steps:['Pomaranƒç ol√∫pte, jedzte s mandƒæami.']},
  {type:'üçé Olovrant',title:'Mrkev s tvarohom',desc:'Beta-karot√©n + kasein.',ings:[{q:'mrkev',a:'100g',g:100},{q:'tvaroh',a:'60g',g:60}],steps:['Mrkvu nakr√°jajte na tyƒçinky, nam√°ƒçajte do tvarohu.']},
  {type:'üçé Olovrant',title:'Okurka s jogurtom',desc:'Hydrat√°cia + probiotika.',ings:[{q:'okurk',a:'100g',g:100},{q:'jogurt',a:'80g',g:80}],steps:['Okurku nakr√°jajte, jedzte s jogurtom.']},
  {type:'üçé Olovrant',title:'Kiwi + gr√©cky jogurt',desc:'Vitam√≠n C + bielkoviny.',ings:[{q:'kiwi',a:'2ks',g:160},{q:'≈ôeck',a:'80g',g:80}],steps:['Kiwi nakr√°jajte do jogurtu.']},
  {type:'üçé Olovrant',title:'Fazole s rajƒçatami',desc:'Vl√°knina + lykop√©n.',ings:[{q:'fazol',a:'100g',g:100},{q:'rajƒçat',a:'1ks',g:100}],steps:['Fazole zmie≈°ajte s nakr√°jan√Ωm rajƒçinom.']},

  {type:'üåô Veƒçera',title:'Losos s mozzarellou a ≈°pen√°tom',desc:'Omega-3 + ≈æelezo.',ings:[{q:'losos',a:'150g',g:150},{q:'mozzarell',a:'80g',g:80},{q:'≈°pen√°t',a:'50g',g:50},{q:'olivov√Ω',a:'1 ly≈æ.',g:13}],steps:['Lososa opeƒçte na panvici.','Pod√°vajte s mozzarellou a ƒçerstv√Ωm ≈°pen√°tom.','Pokvapkajte olejom.']},
  {type:'üåô Veƒçera',title:'Ku≈ôec√≠ stehno s brokolicou',desc:'Prote√≠n + sulforafan.',ings:[{q:'ku≈ôec√≠ stehenn√≠',a:'200g',g:200},{q:'brokolice',a:'150g',g:150},{q:'ƒçesnek',a:'5g',g:5},{q:'olivov√Ω',a:'1 ly≈æ.',g:13}],steps:['Stehno opeƒçte do chrumkava.','Brokolicou oparte s cesnakom.','Pod√°vajte spolu.']},
  {type:'üåô Veƒçera',title:'Tu≈à√°k s fazolami a rajƒçatami',desc:'Bielkoviny + vl√°knina.',ings:[{q:'tu≈à√°k',a:'1 konzerva',g:120},{q:'fazol',a:'100g',g:100},{q:'rajƒçat',a:'100g',g:100},{q:'cibul',a:'30g',g:30}],steps:['Tu≈à√°ka zmie≈°ajte s fazolami.','Pridajte nakr√°jan√© rajƒçiny a cibuƒæu.','Dochu≈•te olivov√Ωm olejom.']},
  {type:'üåô Veƒçera',title:'Mlet√© m√§so s paprikou a ry≈æou',desc:'Kompletn√° veƒçera.',ings:[{q:'mlet√©',a:'150g',g:150},{q:'paprik',a:'100g',g:100},{q:'r√Ω≈æ',a:'80g',g:80},{q:'rajƒçat',a:'100g',g:100}],steps:['Ry≈æu uvarte.','Mlet√© opeƒçte s paprikou a rajƒçatami.','Pod√°vajte na ry≈æi.']},
  {type:'üåô Veƒçera',title:'Pstruh s mrkvou a zemiakmi',desc:'Sladkovodn√Ω omega-3.',ings:[{q:'pstruh',a:'200g',g:200},{q:'mrkev',a:'150g',g:150},{q:'cibul',a:'30g',g:30},{q:'olivov√Ω',a:'1 ly≈æ.',g:13}],steps:['Pstruha opeƒçte vcelku.','Mrkvu poduste na oleji s cibuƒæou.','Pod√°vajte spolu.']},
];

function findProduct(q){
  const prods=D?.products||[];
  return prods.find(p=>p.name.toLowerCase().includes(q.toLowerCase()) && (p.offers||[]).some(o=>selectedStores.has(o.store)));
}

function getMealPrice(p){
  if(!p)return 0;
  const offer=(p.offers||[]).filter(o=>selectedStores.has(o.store)).sort((a,b)=>a.sale_price-b.sale_price)[0];
  return offer?offer.sale_price*0.2:0;
}

function renderPlan(){
  const c=document.getElementById('mealPlan');
  // Assign meals by type for each day
  const types=['üåÖ Ra≈àajky','ü•ê Desiata','‚òÄÔ∏è Obed','üçé Olovrant','üåô Veƒçera'];
  const byType={};
  types.forEach(t=>byType[t]=MEALS.filter(m=>m.type===t));

  let totalKcal=0,totalProt=0,totalCarbs=0,totalFat=0,totalPrice=0;
  let shopItems=[]; // collect for shopping list
  let html='';

  for(let day=1;day<=planDays;day++){
    html+='<div class="day-hdr fi"><div class="day-hdr-t">De≈à '+day+'</div><div class="day-hdr-s">'+(planDays>1?day+'. de≈à jed√°lniƒçka':'Dne≈°n√Ω jed√°lniƒçek')+'</div></div>';
    let dKcal=0,dProt=0,dCarbs=0,dFat=0,dPrice=0;

    types.forEach((type,ti)=>{
      const pool=byType[type];
      const meal=pool[(day-1+ti)%pool.length]; // rotate meals
      let mKcal=0,mProt=0,mCarbs=0,mFat=0,mPrice=0;
      const validIngs=meal.ings.map(ing=>{
        const p=findProduct(ing.q);
        const price=getMealPrice(p);
        mPrice+=price;
        if(p&&p.nutrition){
          const mult=(ing.g||100)/100;
          mKcal+=p.nutrition.kcal*mult;
          mProt+=p.nutrition.protein*mult;
          mCarbs+=p.nutrition.carbs*mult;
          mFat+=p.nutrition.fat*mult;
        }
        if(p)shopItems.push({product:p,amount:ing.a,day:day});
        return{...ing,product:p,price:price};
      });

      dKcal+=mKcal;dProt+=mProt;dCarbs+=mCarbs;dFat+=mFat;dPrice+=mPrice;

      html+='<div class="mc fi" style="animation-delay:'+((day-1)*0.05+ti*0.03)+'s">';
      html+='<div class="mc-h"><div class="mc-type">'+meal.type+'</div><div class="mc-title">'+meal.title+'</div><div class="mc-desc">'+meal.desc+'</div></div>';
      html+='<div class="mc-ings"><div class="mc-ings-t">Ingrediencie</div>';
      validIngs.forEach(vi=>{
        html+='<div class="mc-ing"><span>'+vi.a+' '+(vi.product?vi.product.name:vi.q)+'</span><span class="mip">~'+Math.round(vi.price)+' Kƒç</span></div>';
      });
      html+='</div>';
      html+='<div class="nb"><div class="ni"><div class="ni-v" style="color:var(--accent)">'+Math.round(mKcal)+'</div><div class="ni-l">kcal</div></div>';
      html+='<div class="ni"><div class="ni-v" style="color:var(--green)">'+Math.round(mProt)+'g</div><div class="ni-l">Bielk.</div></div>';
      html+='<div class="ni"><div class="ni-v" style="color:var(--yellow)">'+Math.round(mCarbs)+'g</div><div class="ni-l">Sach.</div></div>';
      html+='<div class="ni"><div class="ni-v" style="color:var(--orange)">'+Math.round(mFat)+'g</div><div class="ni-l">Tuky</div></div></div>';
      html+='<div class="mc-steps">';
      meal.steps.forEach((s,si)=>html+='<div class="mc-step"><b>'+(si+1)+'.</b> '+s+'</div>');
      html+='</div>';
      html+='<div class="mc-foot"><div class="mc-fl">Cena porcie</div><div class="mc-fp">~'+Math.round(mPrice)+' Kƒç</div></div></div>';
    });

    totalKcal+=dKcal;totalProt+=dProt;totalCarbs+=dCarbs;totalFat+=dFat;totalPrice+=dPrice;

    // Day total
    html+='<div class="dtot fi"><div class="dtot-t">De≈à '+day+' ‚Äî s√∫hrn</div><div class="dtot-g">';
    html+='<div><div class="dtot-v" style="color:var(--accent)">'+Math.round(dKcal)+'</div><div class="dtot-l">kcal</div></div>';
    html+='<div><div class="dtot-v" style="color:var(--green)">'+Math.round(dProt)+'g</div><div class="dtot-l">Bielk.</div></div>';
    html+='<div><div class="dtot-v" style="color:var(--yellow)">'+Math.round(dCarbs)+'g</div><div class="dtot-l">Sach.</div></div>';
    html+='<div><div class="dtot-v" style="color:var(--orange)">'+Math.round(dFat)+'g</div><div class="dtot-l">Tuky</div></div>';
    html+='</div><div class="dtot-price">~'+Math.round(dPrice)+' Kƒç / de≈à</div></div>';
  }

  // Grand total if multiple days
  if(planDays>1){
    html+='<div class="budget fi"><div class="budget-t">üìä Celkov√Ω rozpoƒçet na '+planDays+' dn√≠</div>';
    html+='<div class="budget-v">~'+Math.round(totalPrice)+' Kƒç</div>';
    html+='<div class="budget-s">√ò '+Math.round(totalKcal/planDays)+' kcal ¬∑ '+Math.round(totalProt/planDays)+'g bielk. ¬∑ '+Math.round(totalCarbs/planDays)+'g sach. ¬∑ '+Math.round(totalFat/planDays)+'g tukov / de≈à</div></div>';
  }

  c.innerHTML=html;
  // Store shopItems globally for shopping list
  window._shopItems=shopItems;
}

// ==================== SHOPPING LIST ====================
function renderShop(){
  const c=document.getElementById('shopList');
  // Trigger plan render first to compute shopping items
  if(!window._shopItems)renderPlan();
  const items=window._shopItems||[];
  if(!items.length){c.innerHTML='<div class="empty fi"><div class="empty-i">üõí</div><div class="empty-t">Najprv zostav jed√°lniƒçek</div></div>';return;}

  // Group by store
  const byStore={};
  let grandTotal=0;
  items.forEach(it=>{
    if(!it.product)return;
    const offer=(it.product.offers||[]).filter(o=>selectedStores.has(o.store)).sort((a,b)=>a.sale_price-b.sale_price)[0];
    if(!offer)return;
    const store=offer.store;
    if(!byStore[store])byStore[store]={items:{},total:0};
    const key=it.product.name;
    if(!byStore[store].items[key])byStore[store].items[key]={name:it.product.name,amounts:[],price:offer.sale_price,unit:offer.unit,count:0};
    byStore[store].items[key].amounts.push(it.amount);
    byStore[store].items[key].count++;
  });

  // Calc totals
  Object.values(byStore).forEach(store=>{
    Object.values(store.items).forEach(item=>{
      const est=item.price*0.2*item.count;
      item.estPrice=est;
      store.total+=est;
      grandTotal+=est;
    });
  });

  let html='<div class="budget fi"><div class="budget-t">üõí N√°kupn√Ω zoznam na '+planDays+' '+(planDays===1?'de≈à':'dn√≠')+'</div>';
  html+='<div class="budget-v">~'+Math.round(grandTotal)+' Kƒç</div>';
  html+='<div class="budget-s">Rozdelen√© podƒæa obchodov</div></div>';

  const so=['Lidl','Kaufland','Penny Market','Billa','Albert'];
  so.filter(s=>byStore[s]).forEach((store,si)=>{
    const data=byStore[store];
    const items=Object.values(data.items).sort((a,b)=>b.count-a.count);
    html+='<div class="sl-group fi" style="animation-delay:'+(si*.06)+'s">';
    html+='<div class="sl-store"><div class="sg-i" style="background:'+SCOL[store]+'22;color:'+SCOL[store]+';width:32px;height:32px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:16px">'+(SICO[store]||'üè™')+'</div><div class="sl-store-n">'+store+'</div></div>';
    items.forEach(item=>{
      html+='<div class="sl-item"><span class="sl-item-n">'+item.name+'</span><span class="sl-item-a">'+item.amounts.join(', ')+'</span><span class="sl-item-p">~'+Math.round(item.estPrice)+' Kƒç</span></div>';
    });
    html+='<div class="sl-total"><span class="sl-total-l">Celkom '+store+'</span><span class="sl-total-p">~'+Math.round(data.total)+' Kƒç</span></div></div>';
  });

  c.innerHTML=html;
}

// ==================== PROFILE ====================
let profile={goal:'longevity',exclusions:[],watchlist:[]};
try{const saved=localStorage.getItem('bio_profile');if(saved)profile=JSON.parse(saved);}catch(e){}

const GOALS=[
  {id:'longevity',label:'üê¢ Dlhovekos≈• & Anti-Age',desc:'Priorita: Omega-3, polyfenoly, n√≠zky GI'},
  {id:'muscle',label:'üí™ Budovanie svalov',desc:'Priorita: Vysok√© bielkoviny, kvalitn√© sacharidy'},
  {id:'weightloss',label:'üî• Chudnutie (Low Carb)',desc:'Priorita: Bielkoviny, vl√°knina, zdrav√© tuky'},
  {id:'gut',label:'ü¶† Zdrav√Ω Mikrobi√≥m',desc:'Priorita: Fermentovan√© produkty, vl√°knina'}
];
const EXCLS=[{id:'gluten',l:'Lepok'},{id:'lactose',l:'Lakt√≥za'},{id:'nuts',l:'Orechy'},{id:'fish',l:'Ryby'},{id:'eggs',l:'Vajcia'}];

function openProfile(){
  document.getElementById('profModal').classList.remove('hidden');
  renderProfileGoals();
  renderProfileExcl();
  renderProfileWatch();
  checkWatchNotifs();
}
function closeProfile(){document.getElementById('profModal').classList.add('hidden');}
function saveProfile(){
  try{localStorage.setItem('bio_profile',JSON.stringify(profile));}catch(e){}
  closeProfile();
  renderProds(); // re-filter
}

function renderProfileGoals(){
  document.getElementById('profGoals').innerHTML=GOALS.map(g=>
    '<button class="goal-btn '+(profile.goal===g.id?'on':'')+'" onclick="profile.goal=\''+g.id+'\';renderProfileGoals()">'+
    '<div class="goal-name">'+g.label+'</div><div class="goal-desc">'+g.desc+'</div></button>'
  ).join('');
}
function renderProfileExcl(){
  document.getElementById('profExcl').innerHTML=EXCLS.map(e=>{
    const on=profile.exclusions.includes(e.id);
    return '<button class="excl-btn '+(on?'on':'')+'" onclick="toggleExcl(\''+e.id+'\')">'+(on?'üö´ ':'')+e.l+'</button>';
  }).join('');
}
function toggleExcl(id){
  const i=profile.exclusions.indexOf(id);
  if(i>=0)profile.exclusions.splice(i,1);else profile.exclusions.push(id);
  renderProfileExcl();
}
function renderProfileWatch(){
  document.getElementById('watchTags').innerHTML=(profile.watchlist||[]).map((w,i)=>
    '<span class="watch-tag">'+w+' <button onclick="removeWatch('+i+')">√ó</button></span>'
  ).join('')||(profile.watchlist?.length?'':'<span style="font-size:11px;color:var(--text2)">Zatiaƒæ nesleduje≈° ≈æiadne produkty</span>');
}
function addWatch(){
  const inp=document.getElementById('watchInput');
  const v=inp.value.trim();
  if(!v||v.length<2)return;
  if(!profile.watchlist)profile.watchlist=[];
  if(!profile.watchlist.includes(v)){profile.watchlist.push(v);}
  inp.value='';
  renderProfileWatch();
}
function removeWatch(i){profile.watchlist.splice(i,1);renderProfileWatch();}

function checkWatchNotifs(){
  const wl=profile.watchlist||[];
  if(!wl.length)return;
  const prods=D?.products||[];
  const matches=prods.filter(p=>wl.some(w=>p.name.toLowerCase().includes(w.toLowerCase())));
  const btn=document.getElementById('profBtn');
  if(matches.length>0){
    btn.innerHTML='üë§ Profil <span class="notif-dot" style="display:inline-block;width:6px;height:6px;border-radius:50%;background:var(--red);margin-left:2px"></span>';
  }
}

// ==================== CALENDAR ====================
let calDate=new Date();

function renderCalendar(){
  renderCalStrip();
  renderCalProducts();
}

function renderCalStrip(){
  const el=document.getElementById('calStrip');
  const days=['Ne','Po','Ut','St','≈†t','Pi','So'];
  let html='';
  for(let i=0;i<14;i++){
    const d=new Date();d.setDate(d.getDate()+i);
    const isOn=d.toDateString()===calDate.toDateString();
    const prods=getCalProducts(d);
    const hasUrgent=prods.some(p=>{
      const o=p.offers?.[0];if(!o?.valid_until)return false;
      const diff=Math.ceil((new Date(o.valid_until)-d)/(86400000));
      return diff<=2;
    });
    html+='<button class="cal-day '+(isOn?'on':'')+(hasUrgent?' urgent':'')+'" onclick="setCalDate('+i+')">'+
      '<div class="cal-dn">'+days[d.getDay()]+'</div><div class="cal-dd">'+d.getDate()+'</div>'+
      '<div class="cal-dots">'+(prods.length>0?'<div class="cal-dot" style="background:var(--green)"></div>':'')+(hasUrgent?'<div class="cal-dot" style="background:var(--red)"></div>':'')+'</div>'+
    '</button>';
  }
  el.innerHTML=html;
}

function setCalDate(offset){
  calDate=new Date();calDate.setDate(calDate.getDate()+offset);
  renderCalendar();
}

function getCalProducts(d){
  const prods=D?.products||[];
  const ds=d.toISOString().slice(0,10);
  return prods.filter(p=>{
    return (p.offers||[]).some(o=>{
      if(!o.valid_from||!o.valid_until)return false;
      return o.valid_from<=ds&&o.valid_until>=ds&&selectedStores.has(o.store);
    });
  });
}

function renderCalProducts(){
  const el=document.getElementById('calList');
  const prods=getCalProducts(calDate);
  const fmtD=calDate.getDate()+'.'+(calDate.getMonth()+1)+'.'+calDate.getFullYear();
  
  if(!prods.length){
    el.innerHTML='<div class="empty fi"><div class="empty-i">üìÖ</div><div class="empty-t">≈Ωiadne akcie pre '+fmtD+'</div></div>';
    return;
  }

  // Group by store
  const byStore={};
  prods.forEach(p=>{
    (p.offers||[]).filter(o=>selectedStores.has(o.store)&&o.valid_from<=calDate.toISOString().slice(0,10)&&o.valid_until>=calDate.toISOString().slice(0,10)).forEach(o=>{
      if(!byStore[o.store])byStore[o.store]=[];
      byStore[o.store].push({...p,_offer:o});
    });
  });

  let html='<div style="padding:0 16px 8px;font-size:13px;color:var(--text2)">üìÖ Akcie platn√© <b style="color:var(--text)">'+fmtD+'</b> ‚Äî '+prods.length+' produktov</div>';
  
  ['Lidl','Kaufland','Penny Market','Billa','Albert'].filter(s=>byStore[s]).forEach((store,si)=>{
    const items=byStore[store];
    html+='<div class="sg fi" style="animation-delay:'+(si*.06)+'s"><div class="sg-h"><div class="sg-i" style="background:'+SCOL[store]+'22;color:'+SCOL[store]+'">'+(SICO[store]||'üè™')+'</div><div><div class="sg-n">'+store+'</div><div class="sg-c">'+items.length+' produktov</div></div></div>';
    items.forEach(it=>{
      const o=it._offer;
      const daysLeft=Math.ceil((new Date(o.valid_until)-calDate)/(86400000));
      const urgent=daysLeft<=2;
      html+='<div class="sp"><div><div class="sp-n">'+(it.is_priority?'‚≠ê ':'')+it.name+'</div>';
      html+='<div class="sp-m">'+(CL[it.category]?.i||'')+' Score '+(it.clean_score||'-');
      html+=' ¬∑ <span style="color:'+(urgent?'var(--red)':'var(--green)')+'">'+
        (urgent?'Konƒç√≠ o '+daysLeft+' dn√≠!':'Plat√≠ do '+(new Date(o.valid_until).getDate())+'.'+(new Date(o.valid_until).getMonth()+1)+'.')+'</span>';
      html+='</div></div><div><div class="sp-pr">'+fmt(o.sale_price)+' Kƒç</div>';
      if(it.max_discount)html+='<div class="sp-dc">-'+it.max_discount+'%</div>';
      html+='</div></div>';
    });
    html+='</div>';
  });
  el.innerHTML=html;
}

// ==================== SCRAPE TRIGGER ====================
function getToken(){try{return localStorage.getItem('gh_token')}catch(e){return null}}
function closeToken(){document.getElementById('tokenModal').classList.add('hidden')}
function saveToken(){
  const t=document.getElementById('tokenInput').value.trim();
  if(!t){alert('Zadaj token');return;}
  try{localStorage.setItem('gh_token',t)}catch(e){}
  closeToken();
  doTrigger(t);
}

async function triggerScrape(){
  let token=getToken();
  if(!token){document.getElementById('tokenModal').classList.remove('hidden');return;}
  doTrigger(token);
}

async function doTrigger(token){
  const btn=document.getElementById('refBtn');
  btn.textContent='‚è≥ Sp√∫≈°≈•am...';
  btn.classList.add('loading');
  try{
    const r=await fetch('https://api.github.com/repos/PaulR3112/AI-Tools/actions/workflows/scrape.yml/dispatches',{
      method:'POST',
      headers:{'Authorization':'token '+token,'Accept':'application/vnd.github.v3+json','Content-Type':'application/json'},
      body:JSON.stringify({ref:'main'})
    });
    if(r.status===204||r.status===200){
      btn.textContent='‚úÖ Spusten√©!';
      btn.classList.remove('loading');
      btn.classList.add('ok');
      // Countdown: scraper takes ~60-90s, then GitHub Pages rebuild ~30s
      let secs=120;
      const iv=setInterval(()=>{
        secs--;
        btn.textContent='‚è≥ Naƒç√≠tanie za '+secs+'s';
        if(secs<=0){
          clearInterval(iv);
          btn.textContent='üîÑ Naƒç√≠tavam...';
          btn.classList.add('loading');
          // Force reload data (bypass cache)
          loadData().then(()=>{
            btn.textContent='‚úÖ Hotovo!';
            btn.classList.remove('loading');
            btn.classList.add('ok');
            setTimeout(()=>{btn.textContent='üîÑ Aktualizova≈•';btn.classList.remove('ok');},3000);
          });
        }
      },1000);
    }else if(r.status===401){
      try{localStorage.removeItem('gh_token')}catch(e){}
      btn.textContent='üîÑ Aktualizova≈•';
      btn.classList.remove('loading');
      document.getElementById('tokenModal').classList.remove('hidden');
    }else{
      btn.textContent='‚ùå Chyba '+r.status;
      btn.classList.remove('loading');
      btn.classList.add('err');
      setTimeout(()=>{btn.textContent='üîÑ Aktualizova≈•';btn.classList.remove('err');},3000);
    }
  }catch(e){
    btn.textContent='‚ùå Offline';
    btn.classList.remove('loading');
    btn.classList.add('err');
    setTimeout(()=>{btn.textContent='üîÑ Aktualizova≈•';btn.classList.remove('err');},3000);
  }
}

// ==================== SERVICE WORKER ====================
if('serviceWorker' in navigator)navigator.serviceWorker.register('./sw.js').catch(function(){});

// ==================== EMBEDDED DATA ====================
const EDATA={"flyer_week": "11.2-17.2.2026", "generated_at": "2026-02-13T10:00:00Z", "note": "Ceny overen√© 13.2.2026. Platnos≈• let√°kov: Penny (St-Ut), Lidl (Po-Ne), Kaufland (ƒåt-St), Billa (St-Ut), Albert (St-Ut).", "products": [{"name": "Ku≈ôec√≠ prsn√≠ ≈ô√≠zky", "category": "meat", "is_priority": true, "offers": [{"store": "Penny Market", "sale_price": 119.9, "unit": "kg", "valid_from": "2026-02-11", "valid_until": "2026-02-17"}, {"store": "Kaufland", "sale_price": 129.9, "unit": "kg", "valid_from": "2026-02-13", "valid_until": "2026-02-19"}, {"store": "Lidl", "sale_price": 109.9, "unit": "kg", "valid_from": "2026-02-10", "valid_until": "2026-02-16"}], "regular_price": 219.9, "best_price": 109.9, "max_discount": 50, "clean_score": 92, "nutrition": {"kcal": 110, "protein": 23.1, "carbs": 0, "fat": 1.2, "fiber": 0}, "source_url": "https://www.kupi.cz/sleva/kureci-prsni-rizky", "bio_audit": {"microbiome": {"score": 8, "detail": "ƒåist√© dr≈Øbe≈æ√≠ maso ‚Äî minim√°ln√≠ vliv na mikrobiom, bohat√© na tryptofan (prekurzor serotoninu)"}, "cardiovascular": {"score": 9, "detail": "N√≠zk√Ω obsah nasycen√Ωch tuk≈Ø, vysok√Ω pod√≠l b√≠lkovin podporuj√≠c√≠ch kardiovaskul√°rn√≠ zdrav√≠"}, "metabolism": {"score": 9, "detail": "Vysok√Ω termick√Ω efekt b√≠lkovin (TEF ~25%), podporuje svalovou synt√©zu a baz√°ln√≠ metabolismus"}}}, {"name": "Ku≈ôe cel√©", "category": "meat", "is_priority": true, "offers": [{"store": "Lidl", "sale_price": 59.9, "unit": "kg", "valid_from": "2026-02-10", "valid_until": "2026-02-16"}, {"store": "Penny Market", "sale_price": 62.9, "unit": "kg", "valid_from": "2026-02-11", "valid_until": "2026-02-17"}], "regular_price": 109.9, "best_price": 59.9, "max_discount": 45, "clean_score": 85, "nutrition": {"kcal": 167, "protein": 20.0, "carbs": 0, "fat": 9.3, "fiber": 0}, "source_url": "https://www.kupi.cz/sleva/kure-cele", "bio_audit": {"microbiome": {"score": 7, "detail": "Tmav√© maso obsahuje v√≠ce kolagenu a glycinu, prospƒõ≈°n√© pro st≈ôevn√≠ stƒõnu"}, "cardiovascular": {"score": 7, "detail": "Tmav√© maso m√° v√≠ce ≈æeleza a zinku, k≈Ø≈æe zvy≈°uje nasycen√© tuky"}, "metabolism": {"score": 8, "detail": "Kompletn√≠ aminokyselinov√Ω profil, B-vitam√≠ny (B3, B6) podporuj√≠ energetick√Ω metabolismus"}}}, {"name": "Ku≈ôec√≠ stehenn√≠ ≈ô√≠zek", "category": "meat", "is_priority": false, "offers": [{"store": "Kaufland", "sale_price": 89.9, "unit": "kg", "valid_from": "2026-02-13", "valid_until": "2026-02-19"}, {"store": "Billa", "sale_price": 99.9, "unit": "kg", "valid_from": "2026-02-11", "valid_until": "2026-02-17"}], "regular_price": 149.9, "best_price": 89.9, "max_discount": 40, "clean_score": 84, "nutrition": {"kcal": 177, "protein": 18.2, "carbs": 0, "fat": 11.2, "fiber": 0}, "source_url": "https://www.kupi.cz/sleva/kureci-stehenni-rizek", "bio_audit": {"microbiome": {"score": 7, "detail": "Tmav√© maso s vy≈°≈°√≠m obsahem ≈æeleza a zinku"}, "cardiovascular": {"score": 7, "detail": "Vy≈°≈°√≠ obsah tuk≈Ø ne≈æ prsa, ale st√°le dobr√Ω pomƒõr b√≠lkoviny/tuky"}, "metabolism": {"score": 8, "detail": "B-vitam√≠ny a ≈æelezo podporuj√≠ energetick√Ω metabolismus"}}}, {"name": "Vep≈ôov√° plec bez kosti", "category": "meat", "is_priority": false, "offers": [{"store": "Kaufland", "sale_price": 99.9, "unit": "kg", "valid_from": "2026-02-13", "valid_until": "2026-02-19"}], "regular_price": 159.9, "best_price": 99.9, "max_discount": 38, "clean_score": 72, "nutrition": {"kcal": 186, "protein": 18.5, "carbs": 0, "fat": 12.2, "fiber": 0}, "source_url": "https://www.kupi.cz/sleva/veprova-plec", "bio_audit": {"microbiome": {"score": 6, "detail": "Vep≈ôov√© ‚Äî neutr√°ln√≠ vliv na mikrobiom, thiamin (B1) podporuje nervov√Ω syst√©m"}, "cardiovascular": {"score": 5, "detail": "Vy≈°≈°√≠ pod√≠l nasycen√Ωch tuk≈Ø ‚Äî preferovat libov√© ƒç√°sti, max 2√ó t√Ωdnƒõ"}, "metabolism": {"score": 7, "detail": "Dobr√Ω zdroj thiaminu (B1) a selenu"}}}, {"name": "Mlet√© maso mix", "category": "meat", "is_priority": false, "offers": [{"store": "Billa", "sale_price": 79.9, "unit": "500g", "valid_from": "2026-02-11", "valid_until": "2026-02-17"}, {"store": "Albert", "sale_price": 84.9, "unit": "500g", "valid_from": "2026-02-11", "valid_until": "2026-02-17"}], "regular_price": 129.9, "best_price": 79.9, "max_discount": 38, "clean_score": 70, "nutrition": {"kcal": 145, "protein": 20.0, "carbs": 0, "fat": 7.0, "fiber": 0}, "source_url": "https://www.kupi.cz/sleva/mlete-maso", "bio_audit": {"microbiome": {"score": 6, "detail": "Mlet√© maso ‚Äî z√°le≈æ√≠ na kvalitƒõ, vyb√≠rejte s vysok√Ωm % masa"}, "cardiovascular": {"score": 5, "detail": "Smƒõs hovƒõz√≠/vep≈ôov√© ‚Äî st≈ôedn√≠ obsah nasycen√Ωch tuk≈Ø"}, "metabolism": {"score": 7, "detail": "Dobr√Ω zdroj b√≠lkovin, ≈æeleza a B12"}}}, {"name": "Kr≈Øt√≠ prsn√≠ ≈ô√≠zky", "category": "meat", "is_priority": true, "offers": [{"store": "Albert", "sale_price": 199.0, "unit": "kg", "valid_from": "2026-02-11", "valid_until": "2026-02-17"}, {"store": "Billa", "sale_price": 209.0, "unit": "kg", "valid_from": "2026-02-11", "valid_until": "2026-02-17"}], "regular_price": 249.0, "best_price": 199.0, "max_discount": 20, "clean_score": 93, "nutrition": {"kcal": 104, "protein": 24.6, "carbs": 0, "fat": 0.7, "fiber": 0}, "source_url": "https://www.kupi.cz/sleva/kruti-prsni-rizky", "bio_audit": {"microbiome": {"score": 8, "detail": "Kr≈Øt√≠ ‚Äî nejlibovƒõj≈°√≠ dr≈Øbe≈æ√≠ maso, minim√°ln√≠ vliv na mikrobiom"}, "cardiovascular": {"score": 9, "detail": "T√©mƒõ≈ô nulov√Ω obsah tuku, vysok√Ω obsah b√≠lkovin"}, "metabolism": {"score": 9, "detail": "Nejvy≈°≈°√≠ TEF mezi masem, selen a B-vitam√≠ny"}}}, {"name": "Losos filet s k≈Ø≈æ√≠", "category": "fish", "is_priority": true, "offers": [{"store": "Billa", "sale_price": 29.9, "unit": "100g", "valid_from": "2026-02-11", "valid_until": "2026-02-17"}, {"store": "Lidl", "sale_price": 29.9, "unit": "100g", "valid_from": "2026-02-10", "valid_until": "2026-02-16"}], "regular_price": 54.9, "best_price": 29.9, "max_discount": 46, "clean_score": 96, "nutrition": {"kcal": 208, "protein": 20.4, "carbs": 0, "fat": 13.4, "fiber": 0}, "source_url": "https://www.kupi.cz/sleva/losos-filety", "bio_audit": {"microbiome": {"score": 9, "detail": "Omega-3 (EPA/DHA) maj√≠ protiz√°nƒõtliv√Ω √∫ƒçinek na st≈ôevn√≠ mikrobiom"}, "cardiovascular": {"score": 10, "detail": "Omega-3 sni≈æuj√≠ triglyceridy, krevn√≠ tlak a riziko arytmi√≠"}, "metabolism": {"score": 9, "detail": "Vitam√≠n D, selen, astaxanthin ‚Äî omega-3 zlep≈°uj√≠ inzul√≠novou citlivost"}}}, {"name": "Losos Kisuƒç filet Albert", "category": "fish", "is_priority": false, "offers": [{"store": "Albert", "sale_price": 39.9, "unit": "100g", "valid_from": "2026-02-11", "valid_until": "2026-02-17"}], "regular_price": 59.9, "best_price": 39.9, "max_discount": 33, "clean_score": 95, "nutrition": {"kcal": 146, "protein": 21.6, "carbs": 0, "fat": 6.4, "fiber": 0}, "source_url": "https://www.kupi.cz/sleva/losos-kisuc-filet-albert", "bio_audit": {"microbiome": {"score": 9, "detail": "Divok√Ω losos ‚Äî vy≈°≈°√≠ obsah omega-3 ne≈æ chovan√Ω"}, "cardiovascular": {"score": 10, "detail": "Divok√Ω losos m√° lep≈°√≠ pomƒõr omega-3/omega-6"}, "metabolism": {"score": 9, "detail": "Ni≈æ≈°√≠ obsah tuku ne≈æ atlantick√Ω losos, vy≈°≈°√≠ b√≠lkoviny"}}}, {"name": "Tu≈à√°k steak Franz Josef 170g", "category": "fish", "is_priority": false, "offers": [{"store": "Kaufland", "sale_price": 34.9, "unit": "ks", "valid_from": "2026-02-13", "valid_until": "2026-02-19"}, {"store": "Penny Market", "sale_price": 36.9, "unit": "ks", "valid_from": "2026-02-11", "valid_until": "2026-02-17"}], "regular_price": 54.9, "best_price": 34.9, "max_discount": 36, "clean_score": 85, "nutrition": {"kcal": 116, "protein": 25.5, "carbs": 0, "fat": 1.0, "fiber": 0}, "source_url": "https://www.kupi.cz/sleva/tunak-steak", "bio_audit": {"microbiome": {"score": 7, "detail": "Konzervovan√Ω tu≈à√°k ‚Äî minim√°ln√≠ zpracov√°n√≠, pozor na obsah sod√≠ku"}, "cardiovascular": {"score": 8, "detail": "Bohat√Ω na omega-3 a b√≠lkoviny, niacin sni≈æuje LDL cholesterol"}, "metabolism": {"score": 8, "detail": "Niacin (B3) a selen podporuj√≠ metabolismus"}}}, {"name": "Alja≈°sk√° treska Kimbex mra≈æen√° 400g", "category": "fish", "is_priority": false, "offers": [{"store": "Lidl", "sale_price": 69.9, "unit": "400g", "valid_from": "2026-02-10", "valid_until": "2026-02-16"}], "regular_price": 99.9, "best_price": 69.9, "max_discount": 30, "clean_score": 90, "nutrition": {"kcal": 82, "protein": 17.6, "carbs": 0, "fat": 0.7, "fiber": 0}, "source_url": "https://www.kupi.cz/sleva/treska-aljaska", "bio_audit": {"microbiome": {"score": 8, "detail": "ƒåist√© ryb√≠ fil√© ‚Äî lehce straviteln√©"}, "cardiovascular": {"score": 8, "detail": "N√≠zkotuƒçn√° ryba s vysok√Ωm pod√≠lem b√≠lkovin"}, "metabolism": {"score": 8, "detail": "J√≥d podporuje ≈°t√≠tnou ≈æl√°zu, fosfor je kl√≠ƒçov√Ω pro energetick√Ω metabolismus"}}}, {"name": "Pstruh duhov√Ω chlazen√Ω", "category": "fish", "is_priority": false, "offers": [{"store": "Kaufland", "sale_price": 149.9, "unit": "kg", "valid_from": "2026-02-13", "valid_until": "2026-02-19"}], "regular_price": 219.9, "best_price": 149.9, "max_discount": 32, "clean_score": 93, "nutrition": {"kcal": 119, "protein": 20.5, "carbs": 0, "fat": 3.5, "fiber": 0}, "source_url": "https://www.kupi.cz/sleva/pstruh-duhovy", "bio_audit": {"microbiome": {"score": 8, "detail": "Sladkovodn√≠ ryba s omega-3, lehce straviteln√°"}, "cardiovascular": {"score": 9, "detail": "N√≠zk√Ω obsah tuku, omega-3 a vitam√≠n D"}, "metabolism": {"score": 8, "detail": "Kompletn√≠ b√≠lkoviny, fosfor, j√≥d a selen"}}}, {"name": "Tvaroh tuƒçn√Ω Karlova Koruna 250g", "category": "dairy", "is_priority": true, "offers": [{"store": "Penny Market", "sale_price": 12.9, "unit": "ks", "valid_from": "2026-02-11", "valid_until": "2026-02-17"}, {"store": "Kaufland", "sale_price": 14.9, "unit": "ks", "valid_from": "2026-02-13", "valid_until": "2026-02-19"}], "regular_price": 24.9, "best_price": 12.9, "max_discount": 48, "clean_score": 94, "nutrition": {"kcal": 155, "protein": 12.5, "carbs": 3.0, "fat": 10.5, "fiber": 0}, "source_url": "https://www.kupi.cz/sleva/tvaroh-karlova-koruna", "bio_audit": {"microbiome": {"score": 9, "detail": "Tvaroh obsahuje p≈ôirozen√© probiotick√© kultury, kasein ≈æiv√≠ prospƒõ≈°n√© bakterie"}, "cardiovascular": {"score": 7, "detail": "Bohat√Ω na v√°pn√≠k a fosfor"}, "metabolism": {"score": 9, "detail": "Kasein = pomal√© uvol≈àov√°n√≠ aminokyselin, ide√°ln√≠ pro regeneraci"}}}, {"name": "Tvaroh polotuƒçn√Ω Milko 250g", "category": "dairy", "is_priority": true, "offers": [{"store": "Albert", "sale_price": 11.9, "unit": "ks", "valid_from": "2026-02-11", "valid_until": "2026-02-17"}, {"store": "Billa", "sale_price": 12.9, "unit": "ks", "valid_from": "2026-02-11", "valid_until": "2026-02-17"}], "regular_price": 18.9, "best_price": 11.9, "max_discount": 37, "clean_score": 95, "nutrition": {"kcal": 110, "protein": 13.0, "carbs": 3.2, "fat": 4.5, "fiber": 0}, "source_url": "https://www.kupi.cz/slevy/tvaroh", "bio_audit": {"microbiome": {"score": 9, "detail": "Polotuƒçn√Ω tvaroh ‚Äî ni≈æ≈°√≠ nasycen√© tuky, st√°le bohat√Ω na kasein"}, "cardiovascular": {"score": 8, "detail": "M√©nƒõ nasycen√Ωch tuk≈Ø ne≈æ tuƒçn√Ω tvaroh, vhodnej≈°√≠ pri zv√Ω≈°enom cholesterole"}, "metabolism": {"score": 9, "detail": "Vysok√Ω pod√≠l b√≠lkovin, n√≠zke kal√≥rie ‚Äî ide√°lny pre redukciu"}}}, {"name": "Mozzarella Pilos 195g", "category": "dairy", "is_priority": false, "offers": [{"store": "Lidl", "sale_price": 12.9, "unit": "ks", "valid_from": "2026-02-10", "valid_until": "2026-02-16"}], "regular_price": 24.9, "best_price": 12.9, "max_discount": 48, "clean_score": 88, "nutrition": {"kcal": 254, "protein": 18.5, "carbs": 1.0, "fat": 19.5, "fiber": 0}, "source_url": "https://www.kupi.cz/sleva/mozzarella-pilos", "bio_audit": {"microbiome": {"score": 7, "detail": "Fermentovan√Ω s√Ωr s n√≠zkou lakt√≥zou"}, "cardiovascular": {"score": 7, "detail": "St≈ôedn√≠ obsah tuk≈Ø, bohat√Ω na v√°pn√≠k"}, "metabolism": {"score": 7, "detail": "Kompletn√≠ b√≠lkoviny, v√°pn√≠k podporuje lipol√Ωzu"}}}, {"name": "Selsk√Ω jogurt Hollandia 380g", "category": "dairy", "is_priority": true, "offers": [{"store": "Kaufland", "sale_price": 19.9, "unit": "ks", "valid_from": "2026-02-13", "valid_until": "2026-02-19"}, {"store": "Albert", "sale_price": 14.9, "unit": "ks", "valid_from": "2026-02-11", "valid_until": "2026-02-17"}], "regular_price": 34.9, "best_price": 14.9, "max_discount": 57, "clean_score": 92, "nutrition": {"kcal": 72, "protein": 3.5, "carbs": 4.8, "fat": 3.8, "fiber": 0}, "source_url": "https://www.kupi.cz/sleva/selsky-jogurt-hollandia", "bio_audit": {"microbiome": {"score": 9, "detail": "Zraje v kel√≠mku ‚Äî ≈æiv√© kultury L. bulgaricus a S. thermophilus"}, "cardiovascular": {"score": 7, "detail": "Fermentace zlep≈°uje profil mastn√Ωch kyselin"}, "metabolism": {"score": 8, "detail": "Probiotika zlep≈°uj√≠ absorpci ≈æivin a inzul√≠novou citlivost"}}}, {"name": "Hollandia kr√©mov√Ω jogurt 150g", "category": "dairy", "is_priority": false, "offers": [{"store": "Penny Market", "sale_price": 8.9, "unit": "ks", "valid_from": "2026-02-11", "valid_until": "2026-02-17"}], "regular_price": 14.9, "best_price": 8.9, "max_discount": 40, "clean_score": 80, "nutrition": {"kcal": 95, "protein": 3.2, "carbs": 13.0, "fat": 3.2, "fiber": 0}, "source_url": "https://www.kupi.cz/sleva/hollandia-kremovy", "bio_audit": {"microbiome": {"score": 8, "detail": "Kvalitn√≠ jogurt s ≈æiv√Ωmi kulturami"}, "cardiovascular": {"score": 6, "detail": "St≈ôedn√≠ obsah tuk≈Ø, v√°pn√≠k pozitivnƒõ ovliv≈àuje krevn√≠ tlak"}, "metabolism": {"score": 7, "detail": "Probiotika a b√≠lkoviny podporuj√≠ zdrav√Ω metabolismus"}}}, {"name": "B√≠l√Ω jogurt ≈ôeck√Ω typu 140g", "category": "dairy", "is_priority": true, "offers": [{"store": "Lidl", "sale_price": 15.9, "unit": "ks", "valid_from": "2026-02-10", "valid_until": "2026-02-16"}, {"store": "Billa", "sale_price": 17.9, "unit": "ks", "valid_from": "2026-02-11", "valid_until": "2026-02-17"}], "regular_price": 24.9, "best_price": 15.9, "max_discount": 36, "clean_score": 91, "nutrition": {"kcal": 97, "protein": 9.0, "carbs": 3.5, "fat": 5.0, "fiber": 0}, "source_url": "https://www.kupi.cz/slevy/jogurty", "bio_audit": {"microbiome": {"score": 9, "detail": "≈òeck√Ω jogurt ‚Äî vysok√Ω obsah b√≠lkovin a probiotick√Ωch kultur"}, "cardiovascular": {"score": 7, "detail": "Vy≈°≈°√≠ obsah b√≠lkovin ne≈æ bƒõ≈æn√Ω jogurt, p≈ôijateln√Ω obsah tuk≈Ø"}, "metabolism": {"score": 9, "detail": "2√ó v√≠ce b√≠lkovin ne≈æ bƒõ≈æn√Ω jogurt, pomal√© uvol≈àov√°n√≠ aminokyselin"}}}, {"name": "Vejce M podest√Ωlkov√° 30ks", "category": "dairy", "is_priority": true, "offers": [{"store": "Kaufland", "sale_price": 149.9, "unit": "30ks", "valid_from": "2026-02-13", "valid_until": "2026-02-19"}], "regular_price": 189.9, "best_price": 149.9, "max_discount": 21, "clean_score": 98, "nutrition": {"kcal": 143, "protein": 12.6, "carbs": 0.7, "fat": 9.9, "fiber": 0}, "source_url": "https://www.kupi.cz/sleva/vejce-m-30ks", "bio_audit": {"microbiome": {"score": 8, "detail": "Lecitin podporuje integritu st≈ôevn√≠ bari√©ry"}, "cardiovascular": {"score": 8, "detail": "Diet√°rn√≠ cholesterol z vajec m√° minim√°ln√≠ vliv na krevn√≠ cholesterol"}, "metabolism": {"score": 10, "detail": "Cholin, kompletn√≠ b√≠lkovina, vitam√≠n D, B12, selen ‚Äî metabolick√Ω superfood"}}}, {"name": "Vejce S podest√Ωlkov√° 30ks", "category": "dairy", "is_priority": false, "offers": [{"store": "Penny Market", "sale_price": 99.9, "unit": "30ks", "valid_from": "2026-02-11", "valid_until": "2026-02-17"}], "regular_price": 139.9, "best_price": 99.9, "max_discount": 29, "clean_score": 98, "nutrition": {"kcal": 143, "protein": 12.6, "carbs": 0.7, "fat": 9.9, "fiber": 0}, "source_url": "https://www.kupi.cz/sleva/vejce-s-30ks", "bio_audit": {"microbiome": {"score": 8, "detail": "Lecitin podporuje integritu st≈ôevn√≠ bari√©ry"}, "cardiovascular": {"score": 8, "detail": "Diet√°rn√≠ cholesterol z vajec m√° minim√°ln√≠ vliv na krevn√≠ cholesterol"}, "metabolism": {"score": 10, "detail": "Cholin, kompletn√≠ b√≠lkovina, vitam√≠n D, B12, selen"}}}, {"name": "M√°slo Madeta 250g", "category": "dairy", "is_priority": false, "offers": [{"store": "Lidl", "sale_price": 44.9, "unit": "250g", "valid_from": "2026-02-10", "valid_until": "2026-02-16"}, {"store": "Penny Market", "sale_price": 46.9, "unit": "250g", "valid_from": "2026-02-11", "valid_until": "2026-02-17"}], "regular_price": 64.9, "best_price": 44.9, "max_discount": 31, "clean_score": 78, "nutrition": {"kcal": 717, "protein": 0.6, "carbs": 0.8, "fat": 81.0, "fiber": 0}, "source_url": "https://www.kupi.cz/sleva/maslo", "bio_audit": {"microbiome": {"score": 6, "detail": "M√°seln√Ω tuk obsahuje butyr√°t ‚Äî ≈æivinu pro bu≈àky tlust√©ho st≈ôeva"}, "cardiovascular": {"score": 5, "detail": "Vysok√Ω obsah nasycen√Ωch tuk≈Ø ‚Äî max 15-20g dennƒõ"}, "metabolism": {"score": 7, "detail": "Vitam√≠ny A, D, E, K2 rozpustn√© v tuc√≠ch, CLA z ml√©ƒçn√©ho tuku"}}}, {"name": "Pomeranƒçe", "category": "produce", "is_priority": true, "offers": [{"store": "Penny Market", "sale_price": 19.9, "unit": "kg", "valid_from": "2026-02-11", "valid_until": "2026-02-17"}, {"store": "Lidl", "sale_price": 32.9, "unit": "kg", "valid_from": "2026-02-10", "valid_until": "2026-02-16"}], "regular_price": 39.9, "best_price": 19.9, "max_discount": 50, "clean_score": 100, "nutrition": {"kcal": 47, "protein": 0.9, "carbs": 11.8, "fat": 0.1, "fiber": 2.4}, "source_url": "https://www.kupi.cz/sleva/pomerance", "bio_audit": {"microbiome": {"score": 9, "detail": "Pektin ‚Äî rozpustn√° vl√°knina ≈æiv√≠c√≠ Bifidobacterium"}, "cardiovascular": {"score": 9, "detail": "Vitam√≠n C, hesperidin, naringenin ‚Äî flavonoidy sni≈æuj√≠c√≠ tlak"}, "metabolism": {"score": 8, "detail": "Vitam√≠n C zvy≈°uje absorpci ≈æeleza, fol√°t podporuje bunƒõƒçn√Ω metabolismus"}}}, {"name": "Ban√°ny", "category": "produce", "is_priority": false, "offers": [{"store": "Lidl", "sale_price": 22.9, "unit": "kg", "valid_from": "2026-02-10", "valid_until": "2026-02-16"}, {"store": "Kaufland", "sale_price": 24.9, "unit": "kg", "valid_from": "2026-02-13", "valid_until": "2026-02-19"}], "regular_price": 34.9, "best_price": 22.9, "max_discount": 34, "clean_score": 100, "nutrition": {"kcal": 89, "protein": 1.1, "carbs": 22.8, "fat": 0.3, "fiber": 2.6}, "source_url": "https://www.kupi.cz/sleva/banany", "bio_audit": {"microbiome": {"score": 9, "detail": "Rezistentn√≠ ≈°krob (nezral√© ban√°ny) je prebiotikum"}, "cardiovascular": {"score": 8, "detail": "Drasl√≠k reguluje krevn√≠ tlak, B6 sni≈æuje homocystein"}, "metabolism": {"score": 7, "detail": "Rychl√Ω zdroj energie (GI 51), vhodn√Ω post-workout"}}}, {"name": "Jablka ƒçerven√°", "category": "produce", "is_priority": false, "offers": [{"store": "Penny Market", "sale_price": 24.9, "unit": "kg", "valid_from": "2026-02-11", "valid_until": "2026-02-17"}, {"store": "Kaufland", "sale_price": 29.9, "unit": "kg", "valid_from": "2026-02-13", "valid_until": "2026-02-19"}], "regular_price": 44.9, "best_price": 24.9, "max_discount": 45, "clean_score": 100, "nutrition": {"kcal": 52, "protein": 0.3, "carbs": 13.8, "fat": 0.2, "fiber": 2.4}, "source_url": "https://www.kupi.cz/sleva/jablka", "bio_audit": {"microbiome": {"score": 9, "detail": "Pektin a polyfenoly ‚Äî top prebiotikum pre mikrobiotick√∫ diverzitu"}, "cardiovascular": {"score": 8, "detail": "Kvercet√≠n a polyfenoly chr√°nia cievy, zni≈æuj√∫ LDL"}, "metabolism": {"score": 7, "detail": "N√≠zky GI, vl√°knina stabilizuje glyk√©miu"}}}, {"name": "Mrkev", "category": "produce", "is_priority": false, "offers": [{"store": "Penny Market", "sale_price": 9.9, "unit": "kg", "valid_from": "2026-02-11", "valid_until": "2026-02-17"}, {"store": "Kaufland", "sale_price": 12.9, "unit": "kg", "valid_from": "2026-02-13", "valid_until": "2026-02-19"}], "regular_price": 24.9, "best_price": 9.9, "max_discount": 60, "clean_score": 100, "nutrition": {"kcal": 41, "protein": 0.9, "carbs": 9.6, "fat": 0.2, "fiber": 2.8}, "source_url": "https://www.kupi.cz/sleva/mrkev", "bio_audit": {"microbiome": {"score": 8, "detail": "Bohat√© na vl√°kninu a beta-karoten"}, "cardiovascular": {"score": 8, "detail": "Beta-karoten a luteolin ‚Äî antioxidaƒçn√≠ √∫ƒçinky na c√©vy"}, "metabolism": {"score": 8, "detail": "N√≠zkokalorick√©, beta-karoten se p≈ôemƒõ≈àuje na vitam√≠n A"}}}, {"name": "Sal√°tov√° okurka", "category": "produce", "is_priority": false, "offers": [{"store": "Penny Market", "sale_price": 14.9, "unit": "ks", "valid_from": "2026-02-11", "valid_until": "2026-02-17"}, {"store": "Lidl", "sale_price": 16.9, "unit": "ks", "valid_from": "2026-02-10", "valid_until": "2026-02-16"}], "regular_price": 24.9, "best_price": 14.9, "max_discount": 40, "clean_score": 100, "nutrition": {"kcal": 15, "protein": 0.7, "carbs": 3.6, "fat": 0.1, "fiber": 0.5}, "source_url": "https://www.kupi.cz/sleva/salatova-okurka", "bio_audit": {"microbiome": {"score": 7, "detail": "Vysok√Ω obsah vody a vl√°kniny"}, "cardiovascular": {"score": 7, "detail": "Drasl√≠k a ho≈ôƒç√≠k reguluj√≠ krevn√≠ tlak"}, "metabolism": {"score": 7, "detail": "Ultra-n√≠zkokalorick√° (15kcal/100g), hydratuje"}}}, {"name": "Extra sladk√© zlat√© kiwi 4ks", "category": "produce", "is_priority": false, "offers": [{"store": "Lidl", "sale_price": 49.9, "unit": "4ks", "valid_from": "2026-02-10", "valid_until": "2026-02-16"}], "regular_price": 69.9, "best_price": 49.9, "max_discount": 29, "clean_score": 100, "nutrition": {"kcal": 63, "protein": 1.1, "carbs": 15.4, "fat": 0.3, "fiber": 2.0}, "source_url": "https://www.kupi.cz/sleva/zlate-kiwi", "bio_audit": {"microbiome": {"score": 8, "detail": "Kiwi obsahuje actinidin usnad≈àuj√≠c√≠ tr√°ven√≠ b√≠lkovin"}, "cardiovascular": {"score": 8, "detail": "Vitam√≠n C (161mg/100g u zlat√©ho kiwi) chr√°n√≠ c√©vy"}, "metabolism": {"score": 8, "detail": "Jeden z nejvy≈°≈°√≠ch zdroj≈Ø vitam√≠nu C"}}}, {"name": "Hrozny tmav√© bezsemenn√© 500g", "category": "produce", "is_priority": false, "offers": [{"store": "Lidl", "sale_price": 44.9, "unit": "500g", "valid_from": "2026-02-10", "valid_until": "2026-02-16"}, {"store": "Billa", "sale_price": 49.9, "unit": "500g", "valid_from": "2026-02-11", "valid_until": "2026-02-17"}], "regular_price": 69.9, "best_price": 44.9, "max_discount": 36, "clean_score": 95, "nutrition": {"kcal": 69, "protein": 0.7, "carbs": 18.1, "fat": 0.2, "fiber": 0.9}, "source_url": "https://www.kupi.cz/sleva/hrozny-bezsemenne", "bio_audit": {"microbiome": {"score": 8, "detail": "Polyfenoly v hroznech (resveratrol) podporuj√≠ mikrobiotickou diverzitu"}, "cardiovascular": {"score": 9, "detail": "Resveratrol a flavonoidy chr√°n√≠ c√©vn√≠ stƒõny"}, "metabolism": {"score": 7, "detail": "P≈ô√≠rodn√≠ cukry s polyfenoly ‚Äî lep≈°√≠ ne≈æ rafinovan√©"}}}, {"name": "Rajƒçata kulat√°", "category": "produce", "is_priority": false, "offers": [{"store": "Lidl", "sale_price": 29.9, "unit": "kg", "valid_from": "2026-02-10", "valid_until": "2026-02-16"}, {"store": "Penny Market", "sale_price": 34.9, "unit": "kg", "valid_from": "2026-02-11", "valid_until": "2026-02-17"}], "regular_price": 54.9, "best_price": 29.9, "max_discount": 46, "clean_score": 100, "nutrition": {"kcal": 18, "protein": 0.9, "carbs": 3.9, "fat": 0.2, "fiber": 1.2}, "source_url": "https://www.kupi.cz/sleva/rajcata", "bio_audit": {"microbiome": {"score": 8, "detail": "Lykopen a vl√°knina podporuj√∫ zdrav√Ω mikrobiom"}, "cardiovascular": {"score": 9, "detail": "Lykopen je siln√Ω antioxidant chr√°n√≠c√≠ c√©vy, va≈ôen√≠ zvy≈°uje dostupnost"}, "metabolism": {"score": 8, "detail": "Extr√©mne n√≠zkokalorick√©, bohat√© na vitam√≠n C a drasl√≠k"}}}, {"name": "Brokolice", "category": "produce", "is_priority": true, "offers": [{"store": "Kaufland", "sale_price": 34.9, "unit": "ks", "valid_from": "2026-02-13", "valid_until": "2026-02-19"}, {"store": "Albert", "sale_price": 39.9, "unit": "ks", "valid_from": "2026-02-11", "valid_until": "2026-02-17"}], "regular_price": 59.9, "best_price": 34.9, "max_discount": 42, "clean_score": 100, "nutrition": {"kcal": 34, "protein": 2.8, "carbs": 7.0, "fat": 0.4, "fiber": 2.6}, "source_url": "https://www.kupi.cz/sleva/brokolice", "bio_audit": {"microbiome": {"score": 9, "detail": "Sulforafan a indol-3-karbinol ‚Äî podporuj√≠ detoxifikaƒçn√≠ enzymy a zdrav√Ω mikrobiom"}, "cardiovascular": {"score": 9, "detail": "Siln√© protiz√°nƒõtliv√© a antioxidaƒçn√≠ √∫ƒçinky"}, "metabolism": {"score": 9, "detail": "Vl√°knina zpomaluje vst≈ôeb√°v√°n√≠ cukr≈Ø, sulforafan aktivuje Nrf2 dr√°hu"}}}, {"name": "Cibule ≈ælut√° 1kg", "category": "produce", "is_priority": false, "offers": [{"store": "Penny Market", "sale_price": 9.9, "unit": "kg", "valid_from": "2026-02-11", "valid_until": "2026-02-17"}, {"store": "Lidl", "sale_price": 11.9, "unit": "kg", "valid_from": "2026-02-10", "valid_until": "2026-02-16"}], "regular_price": 19.9, "best_price": 9.9, "max_discount": 50, "clean_score": 100, "nutrition": {"kcal": 40, "protein": 1.1, "carbs": 9.3, "fat": 0.1, "fiber": 1.7}, "source_url": "https://www.kupi.cz/sleva/cibule", "bio_audit": {"microbiome": {"score": 9, "detail": "Inul√≠n a FOS ‚Äî siln√© prebiotikum pre Bifidobacterium a Lactobacillus"}, "cardiovascular": {"score": 8, "detail": "Kvercet√≠n a s√≠ra chr√°nia cievy, zni≈æuj√∫ z√°pal"}, "metabolism": {"score": 7, "detail": "N√≠zkokalorick√°, chr√≥m podporuje inzul√≠nov√∫ citlivos≈•"}}}, {"name": "ƒåesnek", "category": "produce", "is_priority": false, "offers": [{"store": "Lidl", "sale_price": 49.9, "unit": "200g", "valid_from": "2026-02-10", "valid_until": "2026-02-16"}], "regular_price": 69.9, "best_price": 49.9, "max_discount": 29, "clean_score": 100, "nutrition": {"kcal": 149, "protein": 6.4, "carbs": 33.1, "fat": 0.5, "fiber": 2.1}, "source_url": "https://www.kupi.cz/sleva/cesnek", "bio_audit": {"microbiome": {"score": 9, "detail": "Allic√≠n a inul√≠n ‚Äî siln√© prebiotick√© a antimikrobi√°lne √∫ƒçinky"}, "cardiovascular": {"score": 9, "detail": "Allic√≠n zni≈æuje krvn√Ω tlak a LDL cholesterol"}, "metabolism": {"score": 8, "detail": "Selenoaminokyseliny a allic√≠n podporuj√∫ detoxifik√°ciu"}}}, {"name": "Paprika ƒçerven√°", "category": "produce", "is_priority": false, "offers": [{"store": "Kaufland", "sale_price": 39.9, "unit": "kg", "valid_from": "2026-02-13", "valid_until": "2026-02-19"}, {"store": "Billa", "sale_price": 44.9, "unit": "kg", "valid_from": "2026-02-11", "valid_until": "2026-02-17"}], "regular_price": 69.9, "best_price": 39.9, "max_discount": 43, "clean_score": 100, "nutrition": {"kcal": 31, "protein": 1.0, "carbs": 6.0, "fat": 0.3, "fiber": 2.1}, "source_url": "https://www.kupi.cz/sleva/paprika", "bio_audit": {"microbiome": {"score": 8, "detail": "Vitam√≠n C a vl√°knina podporuj√∫ mikrobiom"}, "cardiovascular": {"score": 9, "detail": "Vitam√≠n C (127mg/100g) ‚Äî viac ne≈æ pomaranƒç, chr√°ni c√©vy"}, "metabolism": {"score": 8, "detail": "Kapsaic√≠n zvy≈°uje termogen√©zu, vitam√≠n B6 podporuje metabolizmus"}}}, {"name": "≈†pen√°t ƒçerstv√Ω baby 100g", "category": "produce", "is_priority": true, "offers": [{"store": "Billa", "sale_price": 24.9, "unit": "100g", "valid_from": "2026-02-11", "valid_until": "2026-02-17"}, {"store": "Albert", "sale_price": 27.9, "unit": "100g", "valid_from": "2026-02-11", "valid_until": "2026-02-17"}], "regular_price": 39.9, "best_price": 24.9, "max_discount": 38, "clean_score": 100, "nutrition": {"kcal": 23, "protein": 2.9, "carbs": 3.6, "fat": 0.4, "fiber": 2.2}, "source_url": "https://www.kupi.cz/sleva/spenat", "bio_audit": {"microbiome": {"score": 9, "detail": "Vl√°knina a polyfenoly ‚Äî ≈æivia butyr√°t-produkuj√∫ce bakt√©rie"}, "cardiovascular": {"score": 10, "detail": "Nitr√°ty ‚Üí oxid dusnat√Ω = vazodilat√°cia, zn√≠≈æenie krvn√©ho tlaku"}, "metabolism": {"score": 9, "detail": "≈Ωelezo, fol√°t, vitam√≠n K ‚Äî minim√°lne kal√≥rie, maxim√°lna nutriƒçn√° hustota"}}}, {"name": "Borges Olivov√Ω olej extra mild 500ml", "category": "pantry", "is_priority": true, "offers": [{"store": "Kaufland", "sale_price": 99.9, "unit": "500ml", "valid_from": "2026-02-13", "valid_until": "2026-02-19"}], "regular_price": 179.9, "best_price": 99.9, "max_discount": 44, "clean_score": 95, "nutrition": {"kcal": 884, "protein": 0, "carbs": 0, "fat": 100.0, "fiber": 0}, "source_url": "https://www.kupi.cz/sleva/olivovy-olej-borges", "bio_audit": {"microbiome": {"score": 8, "detail": "Polyfenoly podporuj√≠ r≈Øst prospƒõ≈°n√Ωch bakteri√≠"}, "cardiovascular": {"score": 10, "detail": "Kyselina olejov√° ‚Äî z√°klad st≈ôedomo≈ôsk√© diety, sni≈æuje LDL"}, "metabolism": {"score": 8, "detail": "Mononenasycen√© tuky zlep≈°uj√≠ inzul√≠novou citlivost"}}}, {"name": "R√Ω≈æe basmati 1kg", "category": "pantry", "is_priority": false, "offers": [{"store": "Lidl", "sale_price": 39.9, "unit": "kg", "valid_from": "2026-02-10", "valid_until": "2026-02-16"}, {"store": "Penny Market", "sale_price": 42.9, "unit": "kg", "valid_from": "2026-02-11", "valid_until": "2026-02-17"}], "regular_price": 59.9, "best_price": 39.9, "max_discount": 33, "clean_score": 80, "nutrition": {"kcal": 350, "protein": 7.0, "carbs": 78.0, "fat": 0.6, "fiber": 1.0}, "source_url": "https://www.kupi.cz/sleva/ryze-basmati", "bio_audit": {"microbiome": {"score": 6, "detail": "B√≠l√° r√Ω≈æe ‚Äî n√≠zk√Ω obsah vl√°kniny"}, "cardiovascular": {"score": 6, "detail": "Neutr√°ln√≠ vliv, preferovat celozrnn√© varianty"}, "metabolism": {"score": 7, "detail": "Basmati m√° ni≈æ≈°√≠ GI ne≈æ bƒõ≈æn√° b√≠l√° r√Ω≈æe"}}}, {"name": "Ovesn√© vloƒçky Emco 500g", "category": "pantry", "is_priority": true, "offers": [{"store": "Billa", "sale_price": 29.9, "unit": "500g", "valid_from": "2026-02-11", "valid_until": "2026-02-17"}, {"store": "Kaufland", "sale_price": 32.9, "unit": "500g", "valid_from": "2026-02-13", "valid_until": "2026-02-19"}], "regular_price": 49.9, "best_price": 29.9, "max_discount": 40, "clean_score": 95, "nutrition": {"kcal": 372, "protein": 13.5, "carbs": 58.7, "fat": 7.0, "fiber": 10.6}, "source_url": "https://www.kupi.cz/sleva/ovesne-vlocky", "bio_audit": {"microbiome": {"score": 10, "detail": "Beta-glukan ‚Äî zlat√Ω standard prebiot√≠k, mas√≠vne podporuje Bifidobacterium"}, "cardiovascular": {"score": 10, "detail": "3g beta-glukanu dennƒõ prokazatelnƒõ sni≈æuje LDL cholesterol o 5-10%"}, "metabolism": {"score": 9, "detail": "N√≠zk√Ω GI, pomal√© uvol≈àov√°n√≠ energie, stabilizace rann√≠ glyk√©mie"}}}, {"name": "ƒåoƒçka ƒçerven√° 500g", "category": "pantry", "is_priority": true, "offers": [{"store": "Lidl", "sale_price": 34.9, "unit": "500g", "valid_from": "2026-02-10", "valid_until": "2026-02-16"}, {"store": "Albert", "sale_price": 39.9, "unit": "500g", "valid_from": "2026-02-11", "valid_until": "2026-02-17"}], "regular_price": 54.9, "best_price": 34.9, "max_discount": 36, "clean_score": 95, "nutrition": {"kcal": 353, "protein": 25.4, "carbs": 60.1, "fat": 1.1, "fiber": 10.7}, "source_url": "https://www.kupi.cz/sleva/cocka", "bio_audit": {"microbiome": {"score": 10, "detail": "Rezistentn√≠ ≈°krob + oligosacharidy = TOP prebiotikum, masivn√≠ produkce butyr√°tu"}, "cardiovascular": {"score": 9, "detail": "Rozpustn√° vl√°knina sni≈æuje LDL cholesterol, ho≈ôƒç√≠k reguluje srdeƒçn√≠ rytmus"}, "metabolism": {"score": 9, "detail": "N√≠zk√Ω GI, vysok√Ω obsah b√≠lkovin a ≈æeleza, stabilizace glyk√©mie"}}}, {"name": "Tƒõstoviny celozrnn√© Barilla 500g", "category": "pantry", "is_priority": false, "offers": [{"store": "Kaufland", "sale_price": 34.9, "unit": "500g", "valid_from": "2026-02-13", "valid_until": "2026-02-19"}, {"store": "Billa", "sale_price": 37.9, "unit": "500g", "valid_from": "2026-02-11", "valid_until": "2026-02-17"}], "regular_price": 54.9, "best_price": 34.9, "max_discount": 36, "clean_score": 82, "nutrition": {"kcal": 348, "protein": 13.5, "carbs": 65.0, "fat": 2.5, "fiber": 7.5}, "source_url": "https://www.kupi.cz/sleva/testoviny", "bio_audit": {"microbiome": {"score": 7, "detail": "Celozrnn√© tƒõstoviny ‚Äî vl√°knina ≈æiv√≠ prospƒõ≈°n√© bakt√©rie"}, "cardiovascular": {"score": 7, "detail": "Celozrnn√° varianta m√° ni≈æ≈°√≠ GI a v√≠ce ho≈ôƒç√≠ku"}, "metabolism": {"score": 7, "detail": "Pomal√© uvol≈àov√°n√≠ energie, b√≠lkoviny z p≈°enice"}}}, {"name": "Mandle neloupan√© 200g", "category": "pantry", "is_priority": true, "offers": [{"store": "Lidl", "sale_price": 59.9, "unit": "200g", "valid_from": "2026-02-10", "valid_until": "2026-02-16"}], "regular_price": 89.9, "best_price": 59.9, "max_discount": 33, "clean_score": 98, "nutrition": {"kcal": 576, "protein": 21.2, "carbs": 21.7, "fat": 49.4, "fiber": 12.2}, "source_url": "https://www.kupi.cz/sleva/mandle", "bio_audit": {"microbiome": {"score": 9, "detail": "Vl√°knina a polyfenoly z mandl√≠ podporuj√≠ mikrobiotick√∫ diverzitu"}, "cardiovascular": {"score": 10, "detail": "30g o≈ôech≈Ø dennƒõ sni≈æuje kardiovaskul√°rn√≠ riziko o 30% (PREDIMED)"}, "metabolism": {"score": 9, "detail": "Zdrav√© tuky, b√≠lkoviny, ho≈ôƒç√≠k, vitam√≠n E"}}}, {"name": "Fazole b√≠l√© v rajƒçatov√© om√°ƒçce 400g", "category": "pantry", "is_priority": false, "offers": [{"store": "Penny Market", "sale_price": 19.9, "unit": "400g", "valid_from": "2026-02-11", "valid_until": "2026-02-17"}, {"store": "Kaufland", "sale_price": 22.9, "unit": "400g", "valid_from": "2026-02-13", "valid_until": "2026-02-19"}], "regular_price": 34.9, "best_price": 19.9, "max_discount": 43, "clean_score": 88, "nutrition": {"kcal": 81, "protein": 4.6, "carbs": 12.9, "fat": 0.5, "fiber": 3.7}, "source_url": "https://www.kupi.cz/sleva/fazole", "bio_audit": {"microbiome": {"score": 9, "detail": "Lu≈°tƒõniny ‚Äî TOP prebiotikum, lykopen z rajƒçat"}, "cardiovascular": {"score": 8, "detail": "Rozpustn√° vl√°knina sni≈æuje LDL, drasl√≠k reguluje tlak"}, "metabolism": {"score": 8, "detail": "N√≠zk√Ω GI, vysok√Ω obsah b√≠lkovin a vl√°kniny"}}}, {"name": "Med kvƒõtov√Ω Medokomerc 900g", "category": "pantry", "is_priority": false, "offers": [{"store": "Kaufland", "sale_price": 129.9, "unit": "900g", "valid_from": "2026-02-13", "valid_until": "2026-02-19"}], "regular_price": 199.9, "best_price": 129.9, "max_discount": 35, "clean_score": 75, "nutrition": {"kcal": 304, "protein": 0.3, "carbs": 76.0, "fat": 0, "fiber": 0}, "source_url": "https://www.kupi.cz/sleva/med", "bio_audit": {"microbiome": {"score": 7, "detail": "Oligosacharidy v medu maj√∫ prebiotick√Ω √∫ƒçinok, antimikrobi√°lne vlastnosti"}, "cardiovascular": {"score": 5, "detail": "St√°le vysok√Ω obsah cukru ‚Äî max 1 ly≈æica denne"}, "metabolism": {"score": 5, "detail": "Lep≈°ia alternat√≠va k rafinovan√©mu cukru, ale st√°le jednoduch√Ω cukr"}}}]};

// ==================== INIT ====================
loadData();
</script>
</body>
</html>
